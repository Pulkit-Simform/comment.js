<!doctype html>

<!-- Generated with comment.js -->

<meta charset="utf-8">
<title>bbva.ui.dialog.js</title>
<meta name="viewport" content="width=device-width">
<link rel="stylesheet" href="../css/docs.min.css">

<body id="cjs-src">
  <pre><code id="L0"><a href="#L0" class="ln">0</a><span class="c"><span class="c">/*\</span>
</span></code><code id="L1"><a href="#L1" class="ln">1</a><span class="c"><span class="s"> * </span>$B
</span></code><code id="L2"><a href="#L2" class="ln">2</a><span class="c"><span class="s"> * </span>Global namespace <b>for</b> BBVA
</span></code><code id="L3"><a href="#L3" class="ln">3</a><span class="c">\*/</span>
</code><code id="L4"><a href="#L4" class="ln">4</a><span class="c"><span class="c">/*\</span>
</span></code><code id="L5"><a href="#L5" class="ln">5</a><span class="c"><span class="s"> * </span>$B.ui
</span></code><code id="L6"><a href="#L6" class="ln">6</a><span class="c"><span class="s"> * </span>Global namespace <b>for</b> BBVA UI components
</span></code><code id="L7"><a href="#L7" class="ln">7</a><span class="c">\*/</span>
</code><code id="L8"><a href="#L8" class="ln">8</a>
</code><code id="L9"><a href="#L9" class="ln">9</a><span class="c">// <i>"$B.ui.dialog"</i></span>
</code><code id="L10"><a href="#L10" class="ln">10</a><span class="c"><span class="c">/*\</span>
</span></code><code id="L11"><a href="#L11" class="ln">11</a><span class="c"><span class="s"> * </span>$B.ui.dialog
</span></code><code id="L12"><a href="#L12" class="ln">12</a><span class="c"><span class="s"> * </span>Object to perform any operations related to dialogs
</span></code><code id="L13"><a href="#L13" class="ln">13</a><span class="c">\*/</span>
</code><code id="L14"><a href="#L14" class="ln">14</a>(<b>function</b> ($, window) {
</code><code id="L15"><a href="#L15" class="ln">15</a>
</code><code id="L16"><a href="#L16" class="ln">16</a>  $B.provide($B, <i>'ui.dialog'</i>);
</code><code id="L17"><a href="#L17" class="ln">17</a>
</code><code id="L18"><a href="#L18" class="ln">18</a>  <span class="c">// we need to disable resize on overlay</span>
</code><code id="L19"><a href="#L19" class="ln">19</a>  <span class="c">// original overlay create <b>function</b></span>
</code><code id="L20"><a href="#L20" class="ln">20</a>  <b>var</b> overlayCreate<span class="s"> = </span>$.ui.dialog.overlay.create,
</code><code id="L21"><a href="#L21" class="ln">21</a>    document<span class="s"> = </span>window.document;
</code><code id="L22"><a href="#L22" class="ln">22</a>
</code><code id="L23"><a href="#L23" class="ln">23</a>  <span class="c">// prevent jQuery ui from changing the overlay size (we use css)</span>
</code><code id="L24"><a href="#L24" class="ln">24</a>  $.ui.dialog.overlay.resize<span class="s"> = </span><b>function</b> () {};
</code><code id="L25"><a href="#L25" class="ln">25</a>
</code><code id="L26"><a href="#L26" class="ln">26</a>  <span class="c">// overlay create <b>function</b> wrapper</span>
</code><code id="L27"><a href="#L27" class="ln">27</a>  $.extend($.ui.dialog.overlay, {
</code><code id="L28"><a href="#L28" class="ln">28</a>    create: <b>function</b> (dialog) {
</code><code id="L29"><a href="#L29" class="ln">29</a>      <span class="c">// save reference to <b>return</b></span>
</code><code id="L30"><a href="#L30" class="ln">30</a>      <b>var</b> $el<span class="s"> = </span>overlayCreate.call(<b>this</b>, dialog);
</code><code id="L31"><a href="#L31" class="ln">31</a>
</code><code id="L32"><a href="#L32" class="ln">32</a>      <span class="c">// unbind resize event</span>
</code><code id="L33"><a href="#L33" class="ln">33</a>      $(window).off(<i>'resize.dialog-overlay'</i>);
</code><code id="L34"><a href="#L34" class="ln">34</a>
</code><code id="L35"><a href="#L35" class="ln">35</a>      <span class="c">// restore size</span>
</code><code id="L36"><a href="#L36" class="ln">36</a>      $el.css({
</code><code id="L37"><a href="#L37" class="ln">37</a>        width: <i>'<span class="d">100</span>%'</i>,
</code><code id="L38"><a href="#L38" class="ln">38</a>        height: <i>'<span class="d">100</span>%'</i>
</code><code id="L39"><a href="#L39" class="ln">39</a>      });
</code><code id="L40"><a href="#L40" class="ln">40</a>
</code><code id="L41"><a href="#L41" class="ln">41</a>      <span class="c">// allow scrolling by dragging the scrollbar</span>
</code><code id="L42"><a href="#L42" class="ln">42</a>      <span class="c">// remove (as now we are disabling the entire page scrollbar)</span>
</code><code id="L43"><a href="#L43" class="ln">43</a>      setTimeout(<b>function</b> () {
</code><code id="L44"><a href="#L44" class="ln">44</a>        $(document).off(<i>'mousedown.dialog-overlay'</i>);
</code><code id="L45"><a href="#L45" class="ln">45</a>      }, <span class="d">1</span>);
</code><code id="L46"><a href="#L46" class="ln">46</a>
</code><code id="L47"><a href="#L47" class="ln">47</a>      <span class="c">// <b>return</b> original element</span>
</code><code id="L48"><a href="#L48" class="ln">48</a>      <b>return</b> $el;
</code><code id="L49"><a href="#L49" class="ln">49</a>    }
</code><code id="L50"><a href="#L50" class="ln">50</a>  });
</code><code id="L51"><a href="#L51" class="ln">51</a>
</code><code id="L52"><a href="#L52" class="ln">52</a>  <span class="c">// evento para redimensionar y posicionar ventanas modales</span>
</code><code id="L53"><a href="#L53" class="ln">53</a>  $(window).resize(<b>function</b> (ev) {
</code><code id="L54"><a href="#L54" class="ln">54</a>    $B.ui.dialogCenter();
</code><code id="L55"><a href="#L55" class="ln">55</a>  });
</code><code id="L56"><a href="#L56" class="ln">56</a>
</code><code id="L57"><a href="#L57" class="ln">57</a>  <span class="c">// funcion que se encarga de centrar, redimensionar y aplicar scroll a ventanas modales</span>
</code><code id="L58"><a href="#L58" class="ln">58</a>
</code><code id="L59"><a href="#L59" class="ln">59</a>
</code><code id="L60"><a href="#L60" class="ln">60</a><span class="c">  <span class="c">/*\</span>
</span></code><code id="L61"><a href="#L61" class="ln">61</a><span class="c">  <span class="s"> * </span>$B.ui.dialogSecureHeight
</span></code><code id="L62"><a href="#L62" class="ln">62</a><span class="c">   [ property ]
</span></code><code id="L63"><a href="#L63" class="ln">63</a><span class="c">  <span class="s"> * </span>Secure and nice separation from top and bottom of the window
</span></code><code id="L64"><a href="#L64" class="ln">64</a><span class="c">  \*/</span>
</code><code id="L65"><a href="#L65" class="ln">65</a>  $B.ui.dialogSecureHeight<span class="s"> = </span><span class="d">100</span>;
</code><code id="L66"><a href="#L66" class="ln">66</a>
</code><code id="L67"><a href="#L67" class="ln">67</a>
</code><code id="L68"><a href="#L68" class="ln">68</a>  $B.ui.dialogCenter<span class="s"> = </span><b>function</b> ($uiDialog) {
</code><code id="L69"><a href="#L69" class="ln">69</a>    $uiDialog<span class="s"> = </span>$(<i>'.contenidoModal:visible:last'</i>).closest(<i>'.ui-dialog'</i>);
</code><code id="L70"><a href="#L70" class="ln">70</a>
</code><code id="L71"><a href="#L71" class="ln">71</a>    <span class="c">// dont <b>do</b> anything <b>if</b> no modal found</span>
</code><code id="L72"><a href="#L72" class="ln">72</a>    <b>if</b> (!$uiDialog.length) {
</code><code id="L73"><a href="#L73" class="ln">73</a>      <b>return</b>;
</code><code id="L74"><a href="#L74" class="ln">74</a>    }
</code><code id="L75"><a href="#L75" class="ln">75</a>
</code><code id="L76"><a href="#L76" class="ln">76</a>    <b>var</b> $window<span class="s"> = </span>$(window),
</code><code id="L77"><a href="#L77" class="ln">77</a>      windowHeightSecure<span class="s"> = </span>$window.height()<span class="s"> - </span>$B.ui.dialogSecureHeight, <span class="c">// <span class="d">100</span> is the secure margin</span>
</code><code id="L78"><a href="#L78" class="ln">78</a>      $buttonsLayer,
</code><code id="L79"><a href="#L79" class="ln">79</a>      $cuerpoModal,
</code><code id="L80"><a href="#L80" class="ln">80</a>      $contentScroll,
</code><code id="L81"><a href="#L81" class="ln">81</a>      $divViewport,
</code><code id="L82"><a href="#L82" class="ln">82</a>      $divOverview,
</code><code id="L83"><a href="#L83" class="ln">83</a>      $divScrollbar,
</code><code id="L84"><a href="#L84" class="ln">84</a>      $divScrollable,
</code><code id="L85"><a href="#L85" class="ln">85</a>      $elementToScroll,
</code><code id="L86"><a href="#L86" class="ln">86</a>      stepsButtonsHeight,
</code><code id="L87"><a href="#L87" class="ln">87</a>      contentMarginTop,
</code><code id="L88"><a href="#L88" class="ln">88</a>      $contenidoModal,
</code><code id="L89"><a href="#L89" class="ln">89</a>      $buttonsMirrored,
</code><code id="L90"><a href="#L90" class="ln">90</a>      needsToInitScroll<span class="s"> = </span><b>true</b>,
</code><code id="L91"><a href="#L91" class="ln">91</a>      <span class="c">// <b>if</b> fixed height, <b>do</b> not resize</span>
</code><code id="L92"><a href="#L92" class="ln">92</a>      needsResize<span class="s"> = </span>$uiDialog.find(<i>'[data-fixed-height]'</i>).length ? <b>false</b> : <b>true</b>,
</code><code id="L93"><a href="#L93" class="ln">93</a>      buttonAreaCopied<span class="s"> = </span><b>false</b>,
</code><code id="L94"><a href="#L94" class="ln">94</a>      buttonAreaClasses,
</code><code id="L95"><a href="#L95" class="ln">95</a>      divScrollableHeight,
</code><code id="L96"><a href="#L96" class="ln">96</a>      <span class="c">// flag to know <b>if</b> its <i>"modalDetalle"</i> type</span>
</code><code id="L97"><a href="#L97" class="ln">97</a>      isModalDetalle<span class="s"> = </span>$uiDialog.hasClass(<i>'c-contenedores-modalDetalle'</i>),
</code><code id="L98"><a href="#L98" class="ln">98</a>      altoCalculado,
</code><code id="L99"><a href="#L99" class="ln">99</a>
</code><code id="L100"><a href="#L100" class="ln">100</a>      <span class="c">// centers the modal on the window</span>
</code><code id="L101"><a href="#L101" class="ln">101</a>      centerModal<span class="s"> = </span><b>function</b> () {
</code><code id="L102"><a href="#L102" class="ln">102</a>        <b>var</b> top<span class="s"> = </span>($window.height()<span class="s"> - </span>$uiDialog.outerHeight())<span class="s"> / </span><span class="d">2</span>;
</code><code id="L103"><a href="#L103" class="ln">103</a>        $uiDialog.css({
</code><code id="L104"><a href="#L104" class="ln">104</a>          position: <i>'fixed'</i>,
</code><code id="L105"><a href="#L105" class="ln">105</a>          left: ($window.width()<span class="s"> - </span>$uiDialog.width())<span class="s"> / </span><span class="d">2</span><span class="s"> + </span>$window.scrollLeft(),
</code><code id="L106"><a href="#L106" class="ln">106</a>          top: (top &lt; <span class="d">0</span>) ? <span class="d">0</span> : top
</code><code id="L107"><a href="#L107" class="ln">107</a>        });
</code><code id="L108"><a href="#L108" class="ln">108</a>      },
</code><code id="L109"><a href="#L109" class="ln">109</a>
</code><code id="L110"><a href="#L110" class="ln">110</a>      <span class="c">// initializes the custom scroll on the corresponding container</span>
</code><code id="L111"><a href="#L111" class="ln">111</a>      initCustomScroll<span class="s"> = </span><b>function</b> () {
</code><code id="L112"><a href="#L112" class="ln">112</a>        <span class="c">// fix some style problems <b>if</b> modal is modalDetalle</span>
</code><code id="L113"><a href="#L113" class="ln">113</a>        <b>if</b> (isModalDetalle) {
</code><code id="L114"><a href="#L114" class="ln">114</a>          <span class="c">// change scrollbar position</span>
</code><code id="L115"><a href="#L115" class="ln">115</a>          $divScrollbar.css({
</code><code id="L116"><a href="#L116" class="ln">116</a>            right: -<span class="d">16</span>
</code><code id="L117"><a href="#L117" class="ln">117</a>          });
</code><code id="L118"><a href="#L118" class="ln">118</a>          <span class="c">// add padding to viewport</span>
</code><code id="L119"><a href="#L119" class="ln">119</a>          $divViewport.css({
</code><code id="L120"><a href="#L120" class="ln">120</a>            paddingRight: <span class="d">16</span>
</code><code id="L121"><a href="#L121" class="ln">121</a>          });
</code><code id="L122"><a href="#L122" class="ln">122</a>        }
</code><code id="L123"><a href="#L123" class="ln">123</a>
</code><code id="L124"><a href="#L124" class="ln">124</a>        <span class="c">// get the element to make it scrollable</span>
</code><code id="L125"><a href="#L125" class="ln">125</a>        $elementToScroll<span class="s"> = </span>$contentScroll.children(<i>':first'</i>).hasClass(<i>'scrollbar'</i>) ? $contentScroll.find(<i>'.scrollable'</i>).first() : $contentScroll.children(<i>':first'</i>);
</code><code id="L126"><a href="#L126" class="ln">126</a>        <span class="c">// destroy any previous reference tu customscroll plugin</span>
</code><code id="L127"><a href="#L127" class="ln">127</a>        $elementToScroll.parent().customScrollbar(<i>'destroy'</i>);
</code><code id="L128"><a href="#L128" class="ln">128</a>
</code><code id="L129"><a href="#L129" class="ln">129</a>        <span class="c">// init plugin <b>if</b> the scrollable content is higher than its container</span>
</code><code id="L130"><a href="#L130" class="ln">130</a>        <b>if</b> ($elementToScroll.height()<span class="s"> + </span><span class="d">10</span> > $elementToScroll.parent().height()) {
</code><code id="L131"><a href="#L131" class="ln">131</a>          <span class="c">// show scrollbar (initially is hidden)</span>
</code><code id="L132"><a href="#L132" class="ln">132</a>          $divScrollbar.show();
</code><code id="L133"><a href="#L133" class="ln">133</a>          $elementToScroll.parent().customScrollbar({ resizeContent : <b>false</b> });
</code><code id="L134"><a href="#L134" class="ln">134</a>          $divScrollable.css(<i>'margin-top'</i>, contentMarginTop);
</code><code id="L135"><a href="#L135" class="ln">135</a>        }
</code><code id="L136"><a href="#L136" class="ln">136</a>
</code><code id="L137"><a href="#L137" class="ln">137</a>        <span class="c">//set contentScroll margin-top on init</span>
</code><code id="L138"><a href="#L138" class="ln">138</a>        <b>if</b> ($contentScroll.data(<i>'tsb'</i>)) {
</code><code id="L139"><a href="#L139" class="ln">139</a>          $contentScroll.data(<i>'tsb'</i>).thumbSetPos();
</code><code id="L140"><a href="#L140" class="ln">140</a>        }
</code><code id="L141"><a href="#L141" class="ln">141</a>      },
</code><code id="L142"><a href="#L142" class="ln">142</a>
</code><code id="L143"><a href="#L143" class="ln">143</a>      <span class="c">// removes the scroll and reset styles of the elements</span>
</code><code id="L144"><a href="#L144" class="ln">144</a>      removeCustomScroll<span class="s"> = </span><b>function</b> () {
</code><code id="L145"><a href="#L145" class="ln">145</a>        <b>var</b> defaultStyles<span class="s"> = </span>{ height: <i>'auto'</i> };
</code><code id="L146"><a href="#L146" class="ln">146</a>        $divScrollbar.hide();
</code><code id="L147"><a href="#L147" class="ln">147</a>        $cuerpoModal.find(<i>'.contenedorScroll'</i>).css(defaultStyles).customScrollbar(<i>'destroy'</i>);
</code><code id="L148"><a href="#L148" class="ln">148</a>        $cuerpoModal.css(defaultStyles);
</code><code id="L149"><a href="#L149" class="ln">149</a>        $contenidoModal.css(defaultStyles);
</code><code id="L150"><a href="#L150" class="ln">150</a>        $uiDialog.css(defaultStyles);
</code><code id="L151"><a href="#L151" class="ln">151</a>        $divOverview.css($.extend({}, defaultStyles, { position: <i>'<b>static</b>'</i> }));
</code><code id="L152"><a href="#L152" class="ln">152</a>        $divViewport.css($.extend({}, defaultStyles, { overflow: <i>'visible'</i> }));
</code><code id="L153"><a href="#L153" class="ln">153</a>        <span class="c">// <b>do</b> not need scrollbars, mark to <b>false</b></span>
</code><code id="L154"><a href="#L154" class="ln">154</a>        needsToInitScroll<span class="s"> = </span><b>false</b>;
</code><code id="L155"><a href="#L155" class="ln">155</a>      },
</code><code id="L156"><a href="#L156" class="ln">156</a>
</code><code id="L157"><a href="#L157" class="ln">157</a>      getCalculatedHeight<span class="s"> = </span><b>function</b> () {
</code><code id="L158"><a href="#L158" class="ln">158</a>        <b>var</b> maxHeight, resultHeight;
</code><code id="L159"><a href="#L159" class="ln">159</a>
</code><code id="L160"><a href="#L160" class="ln">160</a>        <span class="c">// reset overview position because <b>if</b> not, as its absolute</span>
</code><code id="L161"><a href="#L161" class="ln">161</a>        <span class="c">// doesnt stretches to the width of the content and makes the content div be too tall</span>
</code><code id="L162"><a href="#L162" class="ln">162</a>        $divOverview.css(<i>'position'</i>, <i>'<b>static</b>'</i>);
</code><code id="L163"><a href="#L163" class="ln">163</a>
</code><code id="L164"><a href="#L164" class="ln">164</a>        _.find($(<i>'.scrollable'</i>), <b>function</b> (item) {
</code><code id="L165"><a href="#L165" class="ln">165</a>          <b>if</b> (!$(item).closest(<i>'.scrollable'</i>).length<span class="s"> &amp;&amp; </span>$(item).height() > <span class="d">0</span>) {
</code><code id="L166"><a href="#L166" class="ln">166</a>            maxHeight<span class="s"> = </span>$(item).height();
</code><code id="L167"><a href="#L167" class="ln">167</a>          }
</code><code id="L168"><a href="#L168" class="ln">168</a>        });
</code><code id="L169"><a href="#L169" class="ln">169</a>
</code><code id="L170"><a href="#L170" class="ln">170</a>        <b>if</b> (maxHeight &lt; $contentScroll.height()<span class="s"> || </span>maxHeight > $divOverview.height()) {
</code><code id="L171"><a href="#L171" class="ln">171</a>          resultHeight<span class="s"> = </span>maxHeight;
</code><code id="L172"><a href="#L172" class="ln">172</a>        } <b>else</b> {
</code><code id="L173"><a href="#L173" class="ln">173</a>          resultHeight<span class="s"> = </span>Math.max($contentScroll.height(), $divOverview.height());
</code><code id="L174"><a href="#L174" class="ln">174</a>        }
</code><code id="L175"><a href="#L175" class="ln">175</a>
</code><code id="L176"><a href="#L176" class="ln">176</a>        <span class="c">// restore overview position</span>
</code><code id="L177"><a href="#L177" class="ln">177</a>        $divOverview.css(<i>'position'</i>, <i>'absolute'</i>);
</code><code id="L178"><a href="#L178" class="ln">178</a>
</code><code id="L179"><a href="#L179" class="ln">179</a>        <b>return</b> resultHeight;
</code><code id="L180"><a href="#L180" class="ln">180</a>      },
</code><code id="L181"><a href="#L181" class="ln">181</a>
</code><code id="L182"><a href="#L182" class="ln">182</a>      recalculateContainersHeight<span class="s"> = </span><b>function</b> (altoContenido) {
</code><code id="L183"><a href="#L183" class="ln">183</a>        <b>var</b> variationContenidoModal<span class="s"> = </span>isModalDetalle ? <span class="d">0</span> : <span class="d">39</span>,
</code><code id="L184"><a href="#L184" class="ln">184</a>          variationCuerpoModal<span class="s"> = </span>isModalDetalle ? <span class="d">47</span> : <span class="d">0</span>,
</code><code id="L185"><a href="#L185" class="ln">185</a>          uiDialogHeight<span class="s"> = </span>$uiDialog.height();
</code><code id="L186"><a href="#L186" class="ln">186</a>
</code><code id="L187"><a href="#L187" class="ln">187</a>        <span class="c">// si la modal no necesita scroll se lo quitamos</span>
</code><code id="L188"><a href="#L188" class="ln">188</a>        <b>if</b> ((altoContenido &lt; uiDialogHeight<span class="s"> &amp;&amp; </span>uiDialogHeight &lt;= windowHeightSecure)<span class="s"> || </span>$uiDialog.find(<i>'[data-modal-no-scroll]'</i>).length) {
</code><code id="L189"><a href="#L189" class="ln">189</a>          removeCustomScroll();
</code><code id="L190"><a href="#L190" class="ln">190</a>
</code><code id="L191"><a href="#L191" class="ln">191</a>        <span class="c">// caso en que la ventana modal es mas grande que la ventana</span>
</code><code id="L192"><a href="#L192" class="ln">192</a>        } <b>else</b> <b>if</b> ($cuerpoModal.height() &lt; $divScrollable.height() ||
</code><code id="L193"><a href="#L193" class="ln">193</a>            uiDialogHeight > windowHeightSecure ||
</code><code id="L194"><a href="#L194" class="ln">194</a>            ($cuerpoModal.outerHeight() > uiDialogHeight<span class="s"> &amp;&amp; </span>$uiDialog.find(<i>'.scrollable'</i>).length &lt; <span class="d">2</span>)) {
</code><code id="L195"><a href="#L195" class="ln">195</a>
</code><code id="L196"><a href="#L196" class="ln">196</a>          $divOverview.css(<i>'position'</i>, <i>'absolute'</i>);
</code><code id="L197"><a href="#L197" class="ln">197</a>          $divViewport.css(<i>'overflow'</i>, <i>'hidden'</i>);
</code><code id="L198"><a href="#L198" class="ln">198</a>          $uiDialog.css(<i>'height'</i>, windowHeightSecure);
</code><code id="L199"><a href="#L199" class="ln">199</a>          $contenidoModal.css(<i>'height'</i>, $uiDialog.height()<span class="s"> - </span>variationContenidoModal);
</code><code id="L200"><a href="#L200" class="ln">200</a>          $cuerpoModal.css(<i>'height'</i>, $contenidoModal.height()<span class="s"> - </span>$B.ui.dialogCenterGetHeaderModalHeight($contenidoModal)<span class="s"> - </span>stepsButtonsHeight<span class="s"> - </span>$B.ui.dialogCenterGetContentScrollHeight($contentScroll)<span class="s"> - </span>variationCuerpoModal);
</code><code id="L201"><a href="#L201" class="ln">201</a>
</code><code id="L202"><a href="#L202" class="ln">202</a>          <b>if</b> (needsToInitScroll) {
</code><code id="L203"><a href="#L203" class="ln">203</a>            $contentScroll.css(<i>'height'</i>, $cuerpoModal.height());
</code><code id="L204"><a href="#L204" class="ln">204</a>          }
</code><code id="L205"><a href="#L205" class="ln">205</a>
</code><code id="L206"><a href="#L206" class="ln">206</a>        } <b>else</b> {
</code><code id="L207"><a href="#L207" class="ln">207</a>          needsToInitScroll<span class="s"> = </span><b>false</b>;
</code><code id="L208"><a href="#L208" class="ln">208</a>        }
</code><code id="L209"><a href="#L209" class="ln">209</a>      },
</code><code id="L210"><a href="#L210" class="ln">210</a>
</code><code id="L211"><a href="#L211" class="ln">211</a>      <span class="c">// get containers</span>
</code><code id="L212"><a href="#L212" class="ln">212</a>      getContainers<span class="s"> = </span><b>function</b> () {
</code><code id="L213"><a href="#L213" class="ln">213</a>        $contenidoModal<span class="s"> = </span>$uiDialog.find(<i>'.contenidoModal'</i>).first().css(<i>'height'</i>, <i>'auto'</i>);
</code><code id="L214"><a href="#L214" class="ln">214</a>        $contentScroll<span class="s"> = </span>$cuerpoModal.find(<i>'.contenedorScrollModal'</i>).removeAttr(<i>'style'</i>);
</code><code id="L215"><a href="#L215" class="ln">215</a>        $divViewport<span class="s"> = </span>$contentScroll.find(<i>'.viewportModal'</i>).removeAttr(<i>'style'</i>);
</code><code id="L216"><a href="#L216" class="ln">216</a>        $divOverview<span class="s"> = </span>$contentScroll.find(<i>'.overviewModal'</i>).removeAttr(<i>'style'</i>);
</code><code id="L217"><a href="#L217" class="ln">217</a>        $divScrollable<span class="s"> = </span>$contentScroll.find(<i>'.scrollableModal'</i>).removeAttr(<i>'style'</i>);
</code><code id="L218"><a href="#L218" class="ln">218</a>        $divScrollbar<span class="s"> = </span>$contentScroll.find(<i>'.scrollbarModal'</i>).removeAttr(<i>'style'</i>).css(<i>'display'</i>, <i>'none'</i>);
</code><code id="L219"><a href="#L219" class="ln">219</a>      },
</code><code id="L220"><a href="#L220" class="ln">220</a>
</code><code id="L221"><a href="#L221" class="ln">221</a>      checkIframe<span class="s"> = </span><b>function</b> () {
</code><code id="L222"><a href="#L222" class="ln">222</a>        <span class="c">// <b>if</b> there is only an iframe <b>in</b> the modal deactivate custom scroll</span>
</code><code id="L223"><a href="#L223" class="ln">223</a>        <b>if</b> ($cuerpoModal.children().length<span class="s"> === </span><span class="d">1</span><span class="s"> &amp;&amp; </span>$cuerpoModal.find(<i>'iframe'</i>).length) {
</code><code id="L224"><a href="#L224" class="ln">224</a>          needsToInitScroll<span class="s"> = </span><b>false</b>;
</code><code id="L225"><a href="#L225" class="ln">225</a>          <span class="c">// resize the iframe to occupy the whole content</span>
</code><code id="L226"><a href="#L226" class="ln">226</a>          <b>if</b> (needsResize) {
</code><code id="L227"><a href="#L227" class="ln">227</a>            $cuerpoModal.find(<i>'iframe'</i>).css({ height: <i>'<span class="d">100</span>%'</i>, width: <i>'<span class="d">100</span>%'</i> });
</code><code id="L228"><a href="#L228" class="ln">228</a>          } <b>else</b> {
</code><code id="L229"><a href="#L229" class="ln">229</a>            $uiDialog.find(<i>'.overviewModal'</i>).css({ position: <i>'<b>static</b>'</i> });
</code><code id="L230"><a href="#L230" class="ln">230</a>          }
</code><code id="L231"><a href="#L231" class="ln">231</a>        }
</code><code id="L232"><a href="#L232" class="ln">232</a>      };
</code><code id="L233"><a href="#L233" class="ln">233</a>
</code><code id="L234"><a href="#L234" class="ln">234</a>    $cuerpoModal<span class="s"> = </span>$uiDialog.find(<i>'.cuerpoModal'</i>).first();
</code><code id="L235"><a href="#L235" class="ln">235</a>    $B.ui.dialogCenterAddWrapperScroll($cuerpoModal);
</code><code id="L236"><a href="#L236" class="ln">236</a>
</code><code id="L237"><a href="#L237" class="ln">237</a>    <span class="c">// check <b>if</b> there is an iframe and disabled needsToInitScroll</span>
</code><code id="L238"><a href="#L238" class="ln">238</a>    checkIframe();
</code><code id="L239"><a href="#L239" class="ln">239</a>
</code><code id="L240"><a href="#L240" class="ln">240</a>    <b>if</b> (needsToInitScroll) {
</code><code id="L241"><a href="#L241" class="ln">241</a>      getContainers();
</code><code id="L242"><a href="#L242" class="ln">242</a>      contentMarginTop<span class="s"> = </span>$divScrollable.css(<i>'margin-top'</i>); <span class="c">//guardamos margin-top para al iniciar el scroll dejarlo en la misma posicion</span>
</code><code id="L243"><a href="#L243" class="ln">243</a>
</code><code id="L244"><a href="#L244" class="ln">244</a>      <span class="c">// height of the bottom menu <b>if</b> any</span>
</code><code id="L245"><a href="#L245" class="ln">245</a>      stepsButtonsHeight<span class="s"> = </span>($buttonsMirrored) ? $buttonsMirrored.outerHeight(<b>true</b>) : <span class="d">0</span>;
</code><code id="L246"><a href="#L246" class="ln">246</a>
</code><code id="L247"><a href="#L247" class="ln">247</a>      altoCalculado<span class="s"> = </span>getCalculatedHeight();
</code><code id="L248"><a href="#L248" class="ln">248</a>
</code><code id="L249"><a href="#L249" class="ln">249</a>      <span class="c">// set sizes <b>for</b> both viewport and overview containers</span>
</code><code id="L250"><a href="#L250" class="ln">250</a>      $divViewport.add($divOverview).css({
</code><code id="L251"><a href="#L251" class="ln">251</a>        height: altoCalculado,
</code><code id="L252"><a href="#L252" class="ln">252</a>        width: $contentScroll.width()
</code><code id="L253"><a href="#L253" class="ln">253</a>      });
</code><code id="L254"><a href="#L254" class="ln">254</a>
</code><code id="L255"><a href="#L255" class="ln">255</a>      <span class="c">// resize or reset modal dimensions</span>
</code><code id="L256"><a href="#L256" class="ln">256</a>      recalculateContainersHeight(altoCalculado);
</code><code id="L257"><a href="#L257" class="ln">257</a>
</code><code id="L258"><a href="#L258" class="ln">258</a>      <span class="c">// init scroll <b>if</b> needed</span>
</code><code id="L259"><a href="#L259" class="ln">259</a>      <b>if</b> (needsToInitScroll) {
</code><code id="L260"><a href="#L260" class="ln">260</a>        initCustomScroll();
</code><code id="L261"><a href="#L261" class="ln">261</a>      }
</code><code id="L262"><a href="#L262" class="ln">262</a>    }
</code><code id="L263"><a href="#L263" class="ln">263</a>
</code><code id="L264"><a href="#L264" class="ln">264</a>    <span class="c">// center the modal now that al dimensions are <i>"properly"</i> set</span>
</code><code id="L265"><a href="#L265" class="ln">265</a>    setTimeout(<b>function</b> () {
</code><code id="L266"><a href="#L266" class="ln">266</a>      centerModal();
</code><code id="L267"><a href="#L267" class="ln">267</a>    }, <span class="d">0</span>);
</code><code id="L268"><a href="#L268" class="ln">268</a>
</code><code id="L269"><a href="#L269" class="ln">269</a>    <span class="c">// init timer to check modal content changes</span>
</code><code id="L270"><a href="#L270" class="ln">270</a>    $B.checkContentHeightDialogs.init();
</code><code id="L271"><a href="#L271" class="ln">271</a>  };
</code><code id="L272"><a href="#L272" class="ln">272</a>
</code><code id="L273"><a href="#L273" class="ln">273</a>  <span class="c">// <b>if</b> scrollable wrappers are not present, add them (e.g. modalDetalle)</span>
</code><code id="L274"><a href="#L274" class="ln">274</a>  $B.ui.dialogCenterAddWrapperScroll<span class="s"> = </span><b>function</b> ($cuerpoModal) {
</code><code id="L275"><a href="#L275" class="ln">275</a>    <b>if</b> (!$cuerpoModal.children(<i>'.contenedorScroll'</i>).length) {
</code><code id="L276"><a href="#L276" class="ln">276</a>      $cuerpoModal.children().wrapAll(<i>'&lt;div <b>class</b>="contenedorScroll contenedorScrollModal">&lt;div <b>class</b>="viewport viewportModal">&lt;div <b>class</b>="overview overviewModal">&lt;div <b>class</b>="scrollable scrollableModal">&lt;/div>&lt;/div>&lt;/div>&lt;/div>'</i>);
</code><code id="L277"><a href="#L277" class="ln">277</a>      $cuerpoModal.find(<i>'.scrollableModal'</i>).before(<i>'&lt;div <b>class</b>="scrollbar scrollbarModal" style="display:none;">&lt;div <b>class</b>="boxScroll">&lt;div <b>class</b>="track">&lt;div <b>class</b>="thumb">&lt;div <b>class</b>="end">&lt;/div>&lt;/div>&lt;/div>&lt;span <b>class</b>="jspArrow jspArrowUp jspDisabled">&lt;/span>&lt;span <b>class</b>="jspArrow jspArrowDown">&lt;/span>&lt;/div>&lt;/div>'</i>);
</code><code id="L278"><a href="#L278" class="ln">278</a>    }
</code><code id="L279"><a href="#L279" class="ln">279</a>  };
</code><code id="L280"><a href="#L280" class="ln">280</a>
</code><code id="L281"><a href="#L281" class="ln">281</a>  $B.ui.dialogCenterGetHeaderModalHeight<span class="s"> = </span><b>function</b> ($contenidoModal) {
</code><code id="L282"><a href="#L282" class="ln">282</a>    <b>return</b> ($contenidoModal.find(<i>'.headerModal'</i>).length > <span class="d">0</span>) ? $contenidoModal.find(<i>'.headerModal'</i>).outerHeight(<b>true</b>) : <span class="d">0</span>;
</code><code id="L283"><a href="#L283" class="ln">283</a>  };
</code><code id="L284"><a href="#L284" class="ln">284</a>
</code><code id="L285"><a href="#L285" class="ln">285</a>  $B.ui.dialogCenterGetContentScrollHeight<span class="s"> = </span><b>function</b> ($contentScroll) {
</code><code id="L286"><a href="#L286" class="ln">286</a>    <b>return</b> ($contentScroll.length) ? parseInt($contentScroll.css(<i>'paddingTop'</i>), <span class="d">10</span>) : <span class="d">0</span>;
</code><code id="L287"><a href="#L287" class="ln">287</a>  };
</code><code id="L288"><a href="#L288" class="ln">288</a>
</code><code id="L289"><a href="#L289" class="ln">289</a>  $B.ui.dialogHasSecureHeight<span class="s"> = </span><b>function</b> () {
</code><code id="L290"><a href="#L290" class="ln">290</a>    <b>var</b> $uiDialog<span class="s"> = </span>$(<i>'.contenidoModal:visible:last'</i>).closest(<i>'.ui-dialog'</i>);
</code><code id="L291"><a href="#L291" class="ln">291</a>    <b>return</b> ($uiDialog.find(<i>'[data-modal-no-scroll]'</i>).length<span class="s"> === </span><span class="d">1</span><span class="s"> || </span>$uiDialog.find(<i>'[data-fixed-height]'</i>).length ||
</code><code id="L292"><a href="#L292" class="ln">292</a>      $uiDialog.height() &lt;= $(window).height()<span class="s"> - </span>$B.ui.dialogSecureHeight);
</code><code id="L293"><a href="#L293" class="ln">293</a>  };
</code><code id="L294"><a href="#L294" class="ln">294</a>
</code><code id="L295"><a href="#L295" class="ln">295</a>  $B.ui.dialog<span class="s"> = </span>(<b>function</b> () {
</code><code id="L296"><a href="#L296" class="ln">296</a>    <b>var</b> self<span class="s"> = </span>{},
</code><code id="L297"><a href="#L297" class="ln">297</a>      privates<span class="s"> = </span>{},
</code><code id="L298"><a href="#L298" class="ln">298</a>      helpers<span class="s"> = </span>{},
</code><code id="L299"><a href="#L299" class="ln">299</a>      coreDialogs<span class="s"> = </span>{},
</code><code id="L300"><a href="#L300" class="ln">300</a>      dialogs<span class="s"> = </span>{},
</code><code id="L301"><a href="#L301" class="ln">301</a>      toString<span class="s"> = </span>Object.prototype.toString;
</code><code id="L302"><a href="#L302" class="ln">302</a>
</code><code id="L303"><a href="#L303" class="ln">303</a>    <span class="c">// Helper methods</span>
</code><code id="L304"><a href="#L304" class="ln">304</a>
</code><code id="L305"><a href="#L305" class="ln">305</a>    <span class="c">// Check <b>if</b> obj is an object</span>
</code><code id="L306"><a href="#L306" class="ln">306</a>    helpers.isFunction<span class="s"> = </span><b>function</b> (obj) {
</code><code id="L307"><a href="#L307" class="ln">307</a>      <b>return</b> toString.call(obj)<span class="s"> === </span><i>'[object Function]'</i>;
</code><code id="L308"><a href="#L308" class="ln">308</a>    };
</code><code id="L309"><a href="#L309" class="ln">309</a>
</code><code id="L310"><a href="#L310" class="ln">310</a>    helpers.isObject<span class="s"> = </span><b>function</b> (obj) {
</code><code id="L311"><a href="#L311" class="ln">311</a>      <b>return</b> toString.call(obj)<span class="s"> === </span><i>'[object Object]'</i>;
</code><code id="L312"><a href="#L312" class="ln">312</a>    };
</code><code id="L313"><a href="#L313" class="ln">313</a>
</code><code id="L314"><a href="#L314" class="ln">314</a>    <span class="c">// Check <b>if</b> obj is a string</span>
</code><code id="L315"><a href="#L315" class="ln">315</a>    helpers.isString<span class="s"> = </span><b>function</b> (obj) {
</code><code id="L316"><a href="#L316" class="ln">316</a>      <b>return</b> toString.call(obj)<span class="s"> === </span><i>'[object String]'</i>;
</code><code id="L317"><a href="#L317" class="ln">317</a>    };
</code><code id="L318"><a href="#L318" class="ln">318</a>
</code><code id="L319"><a href="#L319" class="ln">319</a>
</code><code id="L320"><a href="#L320" class="ln">320</a>    <span class="c">// Private methods</span>
</code><code id="L321"><a href="#L321" class="ln">321</a>
</code><code id="L322"><a href="#L322" class="ln">322</a>    <span class="c">// add dialog to dialogs array</span>
</code><code id="L323"><a href="#L323" class="ln">323</a>    privates.add<span class="s"> = </span><b>function</b> (id, $dialog, isCore) {
</code><code id="L324"><a href="#L324" class="ln">324</a>      <b>if</b> (isCore) {
</code><code id="L325"><a href="#L325" class="ln">325</a>        coreDialogs[id]<span class="s"> = </span>$dialog;
</code><code id="L326"><a href="#L326" class="ln">326</a>      } <b>else</b> {
</code><code id="L327"><a href="#L327" class="ln">327</a>        dialogs[id]<span class="s"> = </span>$dialog;
</code><code id="L328"><a href="#L328" class="ln">328</a>      }
</code><code id="L329"><a href="#L329" class="ln">329</a>    };
</code><code id="L330"><a href="#L330" class="ln">330</a>
</code><code id="L331"><a href="#L331" class="ln">331</a>    <span class="c">// <b>delete</b> dialog from dialogs array</span>
</code><code id="L332"><a href="#L332" class="ln">332</a>    privates.del<span class="s"> = </span><b>function</b> (id, isCore) {
</code><code id="L333"><a href="#L333" class="ln">333</a>      <b>if</b> (isCore) {
</code><code id="L334"><a href="#L334" class="ln">334</a>        <b>delete</b> coreDialogs[id];
</code><code id="L335"><a href="#L335" class="ln">335</a>      } <b>else</b> {
</code><code id="L336"><a href="#L336" class="ln">336</a>        <b>delete</b> dialogs[id];
</code><code id="L337"><a href="#L337" class="ln">337</a>      }
</code><code id="L338"><a href="#L338" class="ln">338</a>    };
</code><code id="L339"><a href="#L339" class="ln">339</a>
</code><code id="L340"><a href="#L340" class="ln">340</a>    privates.undelegateEvent<span class="s"> = </span><b>function</b> (id, isCore) {
</code><code id="L341"><a href="#L341" class="ln">341</a>      <b>var</b> button,
</code><code id="L342"><a href="#L342" class="ln">342</a>        $dialog<span class="s"> = </span>isCore ? coreDialogs[id] : dialogs[id];
</code><code id="L343"><a href="#L343" class="ln">343</a>
</code><code id="L344"><a href="#L344" class="ln">344</a>      button<span class="s"> = </span>$dialog.dialog(<i>'option'</i>, <i>'trigger'</i>);
</code><code id="L345"><a href="#L345" class="ln">345</a>      <b>if</b> (button) {
</code><code id="L346"><a href="#L346" class="ln">346</a>        $(document).off(<i>'click.b-dialog-open'</i>, button.selector);
</code><code id="L347"><a href="#L347" class="ln">347</a>      }
</code><code id="L348"><a href="#L348" class="ln">348</a>    };
</code><code id="L349"><a href="#L349" class="ln">349</a>
</code><code id="L350"><a href="#L350" class="ln">350</a>    <span class="c">// make the dialog always tabbable when open</span>
</code><code id="L351"><a href="#L351" class="ln">351</a>    privates.fixDialogTabbing<span class="s"> = </span><b>function</b> ($dialog, $uiDialog) {
</code><code id="L352"><a href="#L352" class="ln">352</a>      <b>var</b> firstTabbable<span class="s"> = </span>$(<i>'body'</i>).find(<i>':tabbable:first'</i>),
</code><code id="L353"><a href="#L353" class="ln">353</a>        lastTabbable<span class="s"> = </span>$(<i>'body'</i>).find(<i>':tabbable:last'</i>),
</code><code id="L354"><a href="#L354" class="ln">354</a>        dialogFirstTabbable,
</code><code id="L355"><a href="#L355" class="ln">355</a>        focusDialogFirstTabbable<span class="s"> = </span><b>function</b> () {
</code><code id="L356"><a href="#L356" class="ln">356</a>          dialogFirstTabbable.focus();
</code><code id="L357"><a href="#L357" class="ln">357</a>        },
</code><code id="L358"><a href="#L358" class="ln">358</a>        focusEvent<span class="s"> = </span><i>'focus.fixTabToDialog'</i>,
</code><code id="L359"><a href="#L359" class="ln">359</a>        dialogTrigger<span class="s"> = </span>$dialog.dialog(<i>'trigger'</i>);
</code><code id="L360"><a href="#L360" class="ln">360</a>
</code><code id="L361"><a href="#L361" class="ln">361</a>      $dialog
</code><code id="L362"><a href="#L362" class="ln">362</a>        .on(<i>'dialogopen'</i>, <b>function</b> () {
</code><code id="L363"><a href="#L363" class="ln">363</a>          dialogFirstTabbable<span class="s"> = </span>$uiDialog.find(<i>':tabbable:first'</i>);
</code><code id="L364"><a href="#L364" class="ln">364</a>          firstTabbable.on(focusEvent, focusDialogFirstTabbable);
</code><code id="L365"><a href="#L365" class="ln">365</a>          lastTabbable.on(focusEvent, focusDialogFirstTabbable);
</code><code id="L366"><a href="#L366" class="ln">366</a>        })
</code><code id="L367"><a href="#L367" class="ln">367</a>        .on(<i>'dialogclose'</i>, <b>function</b> (event) {
</code><code id="L368"><a href="#L368" class="ln">368</a>          firstTabbable.off(focusEvent);
</code><code id="L369"><a href="#L369" class="ln">369</a>          lastTabbable.off(focusEvent);
</code><code id="L370"><a href="#L370" class="ln">370</a>          <span class="c">// <b>return</b> focus to the trigger</span>
</code><code id="L371"><a href="#L371" class="ln">371</a>          <b>if</b> (dialogTrigger) {
</code><code id="L372"><a href="#L372" class="ln">372</a>            dialogTrigger.focus();
</code><code id="L373"><a href="#L373" class="ln">373</a>          }
</code><code id="L374"><a href="#L374" class="ln">374</a>        });
</code><code id="L375"><a href="#L375" class="ln">375</a>    };
</code><code id="L376"><a href="#L376" class="ln">376</a>
</code><code id="L377"><a href="#L377" class="ln">377</a>    privates.reset<span class="s"> = </span><b>function</b> ($dialog) {
</code><code id="L378"><a href="#L378" class="ln">378</a>      <b>var</b> form<span class="s"> = </span>$dialog.find(<i>'form'</i>)[<span class="d">0</span>];
</code><code id="L379"><a href="#L379" class="ln">379</a>      <b>if</b> (form) {
</code><code id="L380"><a href="#L380" class="ln">380</a>        $dialog.on(<i>'dialogclose'</i>, <b>function</b> (ev) {
</code><code id="L381"><a href="#L381" class="ln">381</a>          form.reset();
</code><code id="L382"><a href="#L382" class="ln">382</a>        });
</code><code id="L383"><a href="#L383" class="ln">383</a>      }
</code><code id="L384"><a href="#L384" class="ln">384</a>    };
</code><code id="L385"><a href="#L385" class="ln">385</a>
</code><code id="L386"><a href="#L386" class="ln">386</a>    privates.setWidth<span class="s"> = </span><b>function</b> ($dialog, $uiDialog) {
</code><code id="L387"><a href="#L387" class="ln">387</a>      <b>var</b> widthClass<span class="s"> = </span>$dialog.data(<i>'dialog-width'</i>);
</code><code id="L388"><a href="#L388" class="ln">388</a>      <b>if</b> (widthClass) {
</code><code id="L389"><a href="#L389" class="ln">389</a>        $uiDialog.addClass(widthClass);
</code><code id="L390"><a href="#L390" class="ln">390</a>      }
</code><code id="L391"><a href="#L391" class="ln">391</a>    };
</code><code id="L392"><a href="#L392" class="ln">392</a>
</code><code id="L393"><a href="#L393" class="ln">393</a>
</code><code id="L394"><a href="#L394" class="ln">394</a><span class="c">    <span class="c">/*\</span>
</span></code><code id="L395"><a href="#L395" class="ln">395</a><span class="c">    <span class="s"> * </span>$B.ui.dialog.get
</span></code><code id="L396"><a href="#L396" class="ln">396</a><span class="c">     [ method ]
</span></code><code id="L397"><a href="#L397" class="ln">397</a><span class="c">    <span class="s"> * </span>Get an existing dialog <b>with</b> the given id or any of its ui dialog options
</span></code><code id="L398"><a href="#L398" class="ln">398</a><span class="c">     > Arguments
</span></code><code id="L399"><a href="#L399" class="ln">399</a><span class="c">    <span class="s"> - </span>id (string) id of the dialog
</span></code><code id="L400"><a href="#L400" class="ln">400</a><span class="c">    <span class="s"> - </span>option (string) #optional get the value of ui dialog option (<b>for</b> setting a value see @$B.ui.dialog.set)
</span></code><code id="L401"><a href="#L401" class="ln">401</a><span class="c">    <span class="s"> = </span>(object) jQuery object of the dialog content <b>if</b> only the id is pass
</span></code><code id="L402"><a href="#L402" class="ln">402</a><span class="c">    <span class="s"> * </span>or <b>if</b> an option is passed
</span></code><code id="L403"><a href="#L403" class="ln">403</a><span class="c">    <span class="s"> = </span>(any) Value of the specified option
</span></code><code id="L404"><a href="#L404" class="ln">404</a><span class="c">     > Usage
</span></code><code id="L405"><a href="#L405" class="ln">405</a><span class="c">    <span class="s"> | </span>$B.ui.dialog.get(<i>'id'</i>)
</span></code><code id="L406"><a href="#L406" class="ln">406</a><span class="c">    <span class="s"> | </span>$B.ui.dialog.get(<i>'id'</i>, <i>'zIndex'</i>)
</span></code><code id="L407"><a href="#L407" class="ln">407</a><span class="c">    \*/</span>
</code><code id="L408"><a href="#L408" class="ln">408</a>    self.get<span class="s"> = </span><b>function</b> (id, option) {
</code><code id="L409"><a href="#L409" class="ln">409</a>      <b>if</b> (!id<span class="s"> || </span>!dialogs[id]) {
</code><code id="L410"><a href="#L410" class="ln">410</a>        <b>return</b> <b>false</b>;
</code><code id="L411"><a href="#L411" class="ln">411</a>      } <b>else</b> <b>if</b> (!option) {
</code><code id="L412"><a href="#L412" class="ln">412</a>        <b>return</b> dialogs[id];
</code><code id="L413"><a href="#L413" class="ln">413</a>      } <b>else</b> <b>if</b> (option<span class="s"> &amp;&amp; </span>helpers.isString(option)) { <span class="c">// assume options is a string containing <span class="d">1</span> option to get</span>
</code><code id="L414"><a href="#L414" class="ln">414</a>        <b>return</b> dialogs[id].dialog(<i>'option'</i>, option);
</code><code id="L415"><a href="#L415" class="ln">415</a>      }
</code><code id="L416"><a href="#L416" class="ln">416</a>    };
</code><code id="L417"><a href="#L417" class="ln">417</a>
</code><code id="L418"><a href="#L418" class="ln">418</a>
</code><code id="L419"><a href="#L419" class="ln">419</a><span class="c">    <span class="c">/*\</span>
</span></code><code id="L420"><a href="#L420" class="ln">420</a><span class="c">    <span class="s"> * </span>$B.ui.dialog.exists
</span></code><code id="L421"><a href="#L421" class="ln">421</a><span class="c">     [ method ]
</span></code><code id="L422"><a href="#L422" class="ln">422</a><span class="c">    <span class="s"> * </span>Tells <b>if</b> a specific dialog exists on the stack
</span></code><code id="L423"><a href="#L423" class="ln">423</a><span class="c">     > Arguments
</span></code><code id="L424"><a href="#L424" class="ln">424</a><span class="c">    <span class="s"> - </span>id (string) id of the dialog
</span></code><code id="L425"><a href="#L425" class="ln">425</a><span class="c">    <span class="s"> = </span>(<b>boolean</b>) True <b>if</b> the dialog exists
</span></code><code id="L426"><a href="#L426" class="ln">426</a><span class="c">     > Usage
</span></code><code id="L427"><a href="#L427" class="ln">427</a><span class="c">    <span class="s"> | </span>$B.ui.dialog.exists(<i>'myDialogID'</i>)
</span></code><code id="L428"><a href="#L428" class="ln">428</a><span class="c">    \*/</span>
</code><code id="L429"><a href="#L429" class="ln">429</a>    self.exists<span class="s"> = </span><b>function</b> (id) {
</code><code id="L430"><a href="#L430" class="ln">430</a>      <b>return</b> (id<span class="s"> &amp;&amp; </span>dialogs[id]);
</code><code id="L431"><a href="#L431" class="ln">431</a>    };
</code><code id="L432"><a href="#L432" class="ln">432</a>
</code><code id="L433"><a href="#L433" class="ln">433</a>
</code><code id="L434"><a href="#L434" class="ln">434</a><span class="c">    <span class="c">/*\</span>
</span></code><code id="L435"><a href="#L435" class="ln">435</a><span class="c">    <span class="s"> * </span>$B.ui.dialog.set
</span></code><code id="L436"><a href="#L436" class="ln">436</a><span class="c">     [ method ]
</span></code><code id="L437"><a href="#L437" class="ln">437</a><span class="c">    <span class="s"> * </span>Set an option to an existing dialog
</span></code><code id="L438"><a href="#L438" class="ln">438</a><span class="c">     > Arguments
</span></code><code id="L439"><a href="#L439" class="ln">439</a><span class="c">    <span class="s"> - </span>id (string) id of the dialog
</span></code><code id="L440"><a href="#L440" class="ln">440</a><span class="c">    <span class="s"> - </span>options (object) object setting the ui dialog options
</span></code><code id="L441"><a href="#L441" class="ln">441</a><span class="c">    <span class="s"> = </span>(object) jQuery object of the dialog content
</span></code><code id="L442"><a href="#L442" class="ln">442</a><span class="c">     > Usage
</span></code><code id="L443"><a href="#L443" class="ln">443</a><span class="c">    <span class="s"> | </span>$B.ui.dialog(<i>'id'</i>, {zIndex: <span class="d">0</span>, modal: <b>false</b>});
</span></code><code id="L444"><a href="#L444" class="ln">444</a><span class="c">    \*/</span>
</code><code id="L445"><a href="#L445" class="ln">445</a>    self.set<span class="s"> = </span><b>function</b> (id, options) {
</code><code id="L446"><a href="#L446" class="ln">446</a>      <span class="c">// assume options is an object to set multiple options</span>
</code><code id="L447"><a href="#L447" class="ln">447</a>      <b>if</b> (options<span class="s"> &amp;&amp; </span>helpers.isObject(options)) {
</code><code id="L448"><a href="#L448" class="ln">448</a>        <b>return</b> self.get(id).dialog(options);
</code><code id="L449"><a href="#L449" class="ln">449</a>      } <b>else</b> <b>if</b> (options<span class="s"> &amp;&amp; </span>helpers.isString(options)) { <span class="c">// <b>if</b> is a string <b>return</b> <span class="d">1</span> option</span>
</code><code id="L450"><a href="#L450" class="ln">450</a>        <b>return</b> self.get(id, options);
</code><code id="L451"><a href="#L451" class="ln">451</a>      }
</code><code id="L452"><a href="#L452" class="ln">452</a>    };
</code><code id="L453"><a href="#L453" class="ln">453</a>
</code><code id="L454"><a href="#L454" class="ln">454</a>
</code><code id="L455"><a href="#L455" class="ln">455</a><span class="c">    <span class="c">/*\</span>
</span></code><code id="L456"><a href="#L456" class="ln">456</a><span class="c">    <span class="s"> * </span>$B.ui.dialog.isOpen
</span></code><code id="L457"><a href="#L457" class="ln">457</a><span class="c">     [ method ]
</span></code><code id="L458"><a href="#L458" class="ln">458</a><span class="c">    <span class="s"> * </span>Return a <b>boolean</b> indicating wether the specified dialog is open
</span></code><code id="L459"><a href="#L459" class="ln">459</a><span class="c">     > Arguments
</span></code><code id="L460"><a href="#L460" class="ln">460</a><span class="c">    <span class="s"> - </span>id (string) id of the dialog
</span></code><code id="L461"><a href="#L461" class="ln">461</a><span class="c">    <span class="s"> = </span>(<b>boolean</b>) Returns <b>true</b> or <b>false</b>
</span></code><code id="L462"><a href="#L462" class="ln">462</a><span class="c">     > Usage
</span></code><code id="L463"><a href="#L463" class="ln">463</a><span class="c">    <span class="s"> | </span>$B.ui.dialog.isOpen(<i>'id'</i>);
</span></code><code id="L464"><a href="#L464" class="ln">464</a><span class="c">    \*/</span>
</code><code id="L465"><a href="#L465" class="ln">465</a>    self.isOpen<span class="s"> = </span><b>function</b> (id) {
</code><code id="L466"><a href="#L466" class="ln">466</a>      <b>var</b> $dialog<span class="s"> = </span>self.get(id);
</code><code id="L467"><a href="#L467" class="ln">467</a>      <b>if</b> ($dialog) {
</code><code id="L468"><a href="#L468" class="ln">468</a>        <b>return</b> $dialog.dialog(<i>'isOpen'</i>);
</code><code id="L469"><a href="#L469" class="ln">469</a>      }
</code><code id="L470"><a href="#L470" class="ln">470</a>    };
</code><code id="L471"><a href="#L471" class="ln">471</a>
</code><code id="L472"><a href="#L472" class="ln">472</a>
</code><code id="L473"><a href="#L473" class="ln">473</a><span class="c">    <span class="c">/*\</span>
</span></code><code id="L474"><a href="#L474" class="ln">474</a><span class="c">    <span class="s"> * </span>$B.ui.dialog.moveToTop
</span></code><code id="L475"><a href="#L475" class="ln">475</a><span class="c">     [ method ]
</span></code><code id="L476"><a href="#L476" class="ln">476</a><span class="c">    <span class="s"> * </span>Move a dialog to the top of the stack
</span></code><code id="L477"><a href="#L477" class="ln">477</a><span class="c">     > Arguments
</span></code><code id="L478"><a href="#L478" class="ln">478</a><span class="c">    <span class="s"> - </span>id (string) id of the dialog
</span></code><code id="L479"><a href="#L479" class="ln">479</a><span class="c">    <span class="s"> = </span>(object) jQuery object of the dialog content
</span></code><code id="L480"><a href="#L480" class="ln">480</a><span class="c">     > Usage
</span></code><code id="L481"><a href="#L481" class="ln">481</a><span class="c">    <span class="s"> | </span>$B.ui.dialog.moveToTop(<i>'id'</i>);
</span></code><code id="L482"><a href="#L482" class="ln">482</a><span class="c">    \*/</span>
</code><code id="L483"><a href="#L483" class="ln">483</a>    self.moveToTop<span class="s"> = </span><b>function</b> (id) {
</code><code id="L484"><a href="#L484" class="ln">484</a>      <b>return</b> self.get(id).dialog(<i>'moveToTop'</i>);
</code><code id="L485"><a href="#L485" class="ln">485</a>    };
</code><code id="L486"><a href="#L486" class="ln">486</a>
</code><code id="L487"><a href="#L487" class="ln">487</a>
</code><code id="L488"><a href="#L488" class="ln">488</a><span class="c">    <span class="c">/*\</span>
</span></code><code id="L489"><a href="#L489" class="ln">489</a><span class="c">    <span class="s"> * </span>$B.ui.dialog.destroy
</span></code><code id="L490"><a href="#L490" class="ln">490</a><span class="c">     [ method ]
</span></code><code id="L491"><a href="#L491" class="ln">491</a><span class="c">    <span class="s"> * </span>Destroy an existing dialog <b>with</b> the given id (to destroy all dialogs see @$B.ui.dialog.destroyAll)
</span></code><code id="L492"><a href="#L492" class="ln">492</a><span class="c">     > Arguments
</span></code><code id="L493"><a href="#L493" class="ln">493</a><span class="c">    <span class="s"> - </span>id (string) id of the dialog to destroy
</span></code><code id="L494"><a href="#L494" class="ln">494</a><span class="c">    <span class="s"> = </span>(<b>boolean</b>) returns <b>true</b> <b>if</b> success, <b>false</b> <b>if</b> no dialog to <b>delete</b>
</span></code><code id="L495"><a href="#L495" class="ln">495</a><span class="c">     > Usage
</span></code><code id="L496"><a href="#L496" class="ln">496</a><span class="c">    <span class="s"> | </span>$B.ui.dialog.destroy(<i>'id'</i>);
</span></code><code id="L497"><a href="#L497" class="ln">497</a><span class="c">    \*/</span>
</code><code id="L498"><a href="#L498" class="ln">498</a>    self.destroy<span class="s"> = </span><b>function</b> (id) {
</code><code id="L499"><a href="#L499" class="ln">499</a>      <b>var</b> dialogToDestroy<span class="s"> = </span>dialogs[id],
</code><code id="L500"><a href="#L500" class="ln">500</a>        isCore<span class="s"> = </span><b>false</b>;
</code><code id="L501"><a href="#L501" class="ln">501</a>
</code><code id="L502"><a href="#L502" class="ln">502</a>      <b>if</b> (!dialogs[id]) {
</code><code id="L503"><a href="#L503" class="ln">503</a>        dialogToDestroy<span class="s"> = </span>coreDialogs[id];
</code><code id="L504"><a href="#L504" class="ln">504</a>        <b>if</b> (dialogToDestroy) {
</code><code id="L505"><a href="#L505" class="ln">505</a>          isCore<span class="s"> = </span><b>true</b>;
</code><code id="L506"><a href="#L506" class="ln">506</a>        }
</code><code id="L507"><a href="#L507" class="ln">507</a>      }
</code><code id="L508"><a href="#L508" class="ln">508</a>
</code><code id="L509"><a href="#L509" class="ln">509</a>
</code><code id="L510"><a href="#L510" class="ln">510</a><span class="c">      /*
</span></code><code id="L511"><a href="#L511" class="ln">511</a><span class="c">      Esta condicion anula el metodo. Asi sirve solo para destruir la modal de loading.
</span></code><code id="L512"><a href="#L512" class="ln">512</a><span class="c">      Si lo comento, no funcionan modales en varios sitios. Me imagino que se esta llamando el metodo de
</span></code><code id="L513"><a href="#L513" class="ln">513</a><span class="c">      destrotAll en demasiados sitios. Metodo que por cierto no va hacer nada mas que quitar la modal del loading
</span></code><code id="L514"><a href="#L514" class="ln">514</a><span class="c">      -----------------------------------------------------------------------------------
</span></code><code id="L515"><a href="#L515" class="ln">515</a><span class="c">      */</span>
</code><code id="L516"><a href="#L516" class="ln">516</a>      <b>if</b> ((self.isOpen(id))<span class="s"> &amp;&amp; </span>(id !== <i>'loading-app'</i>)) {
</code><code id="L517"><a href="#L517" class="ln">517</a>        <b>return</b>;
</code><code id="L518"><a href="#L518" class="ln">518</a>      }
</code><code id="L519"><a href="#L519" class="ln">519</a>
</code><code id="L520"><a href="#L520" class="ln">520</a>      <b>if</b> (dialogToDestroy) {
</code><code id="L521"><a href="#L521" class="ln">521</a>        <span class="c">// undelegate click event that opens the dialog</span>
</code><code id="L522"><a href="#L522" class="ln">522</a>        privates.undelegateEvent(id, isCore);
</code><code id="L523"><a href="#L523" class="ln">523</a>        <span class="c">// destroy ui dialog</span>
</code><code id="L524"><a href="#L524" class="ln">524</a>        dialogToDestroy.dialog(<i>'destroy'</i>).remove();
</code><code id="L525"><a href="#L525" class="ln">525</a>        <span class="c">// <b>delete</b> from dialogs stack</span>
</code><code id="L526"><a href="#L526" class="ln">526</a>        privates.del(id, isCore);
</code><code id="L527"><a href="#L527" class="ln">527</a>
</code><code id="L528"><a href="#L528" class="ln">528</a>        self.disableBodyScroll(<b>false</b>);
</code><code id="L529"><a href="#L529" class="ln">529</a>        <b>return</b> <b>true</b>;
</code><code id="L530"><a href="#L530" class="ln">530</a>      }
</code><code id="L531"><a href="#L531" class="ln">531</a>      <b>return</b> <b>false</b>;
</code><code id="L532"><a href="#L532" class="ln">532</a>    };
</code><code id="L533"><a href="#L533" class="ln">533</a>
</code><code id="L534"><a href="#L534" class="ln">534</a>
</code><code id="L535"><a href="#L535" class="ln">535</a><span class="c">    <span class="c">/*\</span>
</span></code><code id="L536"><a href="#L536" class="ln">536</a><span class="c">    <span class="s"> * </span>$B.ui.dialog.destroyAll
</span></code><code id="L537"><a href="#L537" class="ln">537</a><span class="c">     [ method ]
</span></code><code id="L538"><a href="#L538" class="ln">538</a><span class="c">    <span class="s"> * </span>Destroy all dialogs that were created (to destroy a specific dialog see @$B.ui.dialog.destroy)
</span></code><code id="L539"><a href="#L539" class="ln">539</a><span class="c">    <span class="s"> = </span>(<b>boolean</b>) returns <b>true</b> <b>if</b> success, <b>false</b> <b>if</b> no dialogs to <b>delete</b>
</span></code><code id="L540"><a href="#L540" class="ln">540</a><span class="c">     > Usage
</span></code><code id="L541"><a href="#L541" class="ln">541</a><span class="c">    <span class="s"> | </span>$B.ui.dialog.destroyAll();
</span></code><code id="L542"><a href="#L542" class="ln">542</a><span class="c">    \*/</span>
</code><code id="L543"><a href="#L543" class="ln">543</a>    self.destroyAll<span class="s"> = </span><b>function</b> () {
</code><code id="L544"><a href="#L544" class="ln">544</a>      <b>var</b> id;
</code><code id="L545"><a href="#L545" class="ln">545</a>      <span class="c">// <b>return</b> <b>if</b> there are no dialogs</span>
</code><code id="L546"><a href="#L546" class="ln">546</a>      <b>if</b> ($.isEmptyObject(dialogs)) {
</code><code id="L547"><a href="#L547" class="ln">547</a>        <b>return</b> <b>false</b>;
</code><code id="L548"><a href="#L548" class="ln">548</a>      }
</code><code id="L549"><a href="#L549" class="ln">549</a>
</code><code id="L550"><a href="#L550" class="ln">550</a>      <span class="c">// <b>delete</b> all dialogs from stack</span>
</code><code id="L551"><a href="#L551" class="ln">551</a>      <b>for</b> (id <b>in</b> dialogs) {
</code><code id="L552"><a href="#L552" class="ln">552</a>        <b>if</b> (dialogs.hasOwnProperty(id)) {
</code><code id="L553"><a href="#L553" class="ln">553</a>          self.destroy(id);
</code><code id="L554"><a href="#L554" class="ln">554</a>        }
</code><code id="L555"><a href="#L555" class="ln">555</a>      }
</code><code id="L556"><a href="#L556" class="ln">556</a>      <b>return</b> <b>true</b>;
</code><code id="L557"><a href="#L557" class="ln">557</a>    };
</code><code id="L558"><a href="#L558" class="ln">558</a>
</code><code id="L559"><a href="#L559" class="ln">559</a>
</code><code id="L560"><a href="#L560" class="ln">560</a><span class="c">    <span class="c">/*\</span>
</span></code><code id="L561"><a href="#L561" class="ln">561</a><span class="c">    <span class="s"> * </span>$B.ui.dialog.open
</span></code><code id="L562"><a href="#L562" class="ln">562</a><span class="c">     [ method ]
</span></code><code id="L563"><a href="#L563" class="ln">563</a><span class="c">    <span class="s"> * </span>Open an existing dialog <b>with</b> the given id
</span></code><code id="L564"><a href="#L564" class="ln">564</a><span class="c">     > Arguments
</span></code><code id="L565"><a href="#L565" class="ln">565</a><span class="c">    <span class="s"> - </span>id (string) id of the dialog to open
</span></code><code id="L566"><a href="#L566" class="ln">566</a><span class="c">    <span class="s"> - </span>options (object) #optional object containing options to create a dialog
</span></code><code id="L567"><a href="#L567" class="ln">567</a><span class="c">    <span class="s"> = </span>(object) jQuery object of the dialog content
</span></code><code id="L568"><a href="#L568" class="ln">568</a><span class="c">     > Usage
</span></code><code id="L569"><a href="#L569" class="ln">569</a><span class="c">    <span class="s"> | </span>$B.ui.dialog.open(<i>'id'</i>);
</span></code><code id="L570"><a href="#L570" class="ln">570</a><span class="c">    <span class="s"> | </span><span class="c">// <b>if</b> an options object is passed it will be created and opened</span>
</span></code><code id="L571"><a href="#L571" class="ln">571</a><span class="c">    <span class="s"> | </span>$B.ui.dialog.open(<i>'MyID'</i>, {
</span></code><code id="L572"><a href="#L572" class="ln">572</a><span class="c">    <span class="s"> | </span>  modal: <b>true</b>,
</span></code><code id="L573"><a href="#L573" class="ln">573</a><span class="c">    <span class="s"> | </span>  width: <span class="d">500</span>,
</span></code><code id="L574"><a href="#L574" class="ln">574</a><span class="c">    <span class="s"> | </span>  height: <span class="d">300</span>
</span></code><code id="L575"><a href="#L575" class="ln">575</a><span class="c">    <span class="s"> | </span>});
</span></code><code id="L576"><a href="#L576" class="ln">576</a><span class="c">    \*/</span>
</code><code id="L577"><a href="#L577" class="ln">577</a>    self.open<span class="s"> = </span><b>function</b> (id, options) {
</code><code id="L578"><a href="#L578" class="ln">578</a>      <b>if</b> (!self.get(id)<span class="s"> &amp;&amp; </span>!options) {
</code><code id="L579"><a href="#L579" class="ln">579</a>        <b>throw</b> <b>new</b> Error($B.app.literals.coreLiterals.no_dialog_with_id<span class="s"> + </span>id<span class="s"> + </span>$B.app.literals.coreLiterals.no_options_for_dialog);
</code><code id="L580"><a href="#L580" class="ln">580</a>
</code><code id="L581"><a href="#L581" class="ln">581</a>      <span class="c">// <b>if</b> there is a dialog <b>with</b> that id open it</span>
</code><code id="L582"><a href="#L582" class="ln">582</a>      } <b>else</b> <b>if</b> (self.get(id)) {
</code><code id="L583"><a href="#L583" class="ln">583</a>        <span class="c">// call jQuery ui open</span>
</code><code id="L584"><a href="#L584" class="ln">584</a>        self.get(id).dialog(<i>'open'</i>);
</code><code id="L585"><a href="#L585" class="ln">585</a>
</code><code id="L586"><a href="#L586" class="ln">586</a>        <span class="c">// <b>return</b> dialog itself to allow chain</span>
</code><code id="L587"><a href="#L587" class="ln">587</a>        <b>return</b> self.get(id);
</code><code id="L588"><a href="#L588" class="ln">588</a>
</code><code id="L589"><a href="#L589" class="ln">589</a>      <span class="c">// <b>if</b> options are provided the dialog will be created and opened</span>
</code><code id="L590"><a href="#L590" class="ln">590</a>      } <b>else</b> <b>if</b> (options<span class="s"> &amp;&amp; </span>helpers.isObject(options)) {
</code><code id="L591"><a href="#L591" class="ln">591</a>        <b>if</b> (id) {
</code><code id="L592"><a href="#L592" class="ln">592</a>          options.id<span class="s"> = </span>id;
</code><code id="L593"><a href="#L593" class="ln">593</a>        }
</code><code id="L594"><a href="#L594" class="ln">594</a>        <span class="c">// create the dialog</span>
</code><code id="L595"><a href="#L595" class="ln">595</a>        <b>return</b> self.create(options).dialog(<i>'open'</i>);
</code><code id="L596"><a href="#L596" class="ln">596</a>      }
</code><code id="L597"><a href="#L597" class="ln">597</a>    };
</code><code id="L598"><a href="#L598" class="ln">598</a>
</code><code id="L599"><a href="#L599" class="ln">599</a>
</code><code id="L600"><a href="#L600" class="ln">600</a><span class="c">    <span class="c">/*\</span>
</span></code><code id="L601"><a href="#L601" class="ln">601</a><span class="c">    <span class="s"> * </span>$B.ui.dialog.close
</span></code><code id="L602"><a href="#L602" class="ln">602</a><span class="c">     [ method ]
</span></code><code id="L603"><a href="#L603" class="ln">603</a><span class="c">    <span class="s"> * </span>Close an existing dialog <b>with</b> the given id
</span></code><code id="L604"><a href="#L604" class="ln">604</a><span class="c">     > Arguments
</span></code><code id="L605"><a href="#L605" class="ln">605</a><span class="c">    <span class="s"> - </span>id (string) id of the dialog to open
</span></code><code id="L606"><a href="#L606" class="ln">606</a><span class="c">    <span class="s"> = </span>(object) jQuery object of the dialog content
</span></code><code id="L607"><a href="#L607" class="ln">607</a><span class="c">     > Usage
</span></code><code id="L608"><a href="#L608" class="ln">608</a><span class="c">    <span class="s"> | </span>$B.ui.dialog.close(<i>'id'</i>);
</span></code><code id="L609"><a href="#L609" class="ln">609</a><span class="c">    \*/</span>
</code><code id="L610"><a href="#L610" class="ln">610</a>    self.close<span class="s"> = </span><b>function</b> (id) {
</code><code id="L611"><a href="#L611" class="ln">611</a>      <b>if</b> (!self.get(id)) {
</code><code id="L612"><a href="#L612" class="ln">612</a>        <b>throw</b> <b>new</b> Error($B.app.literals.coreLiterals.no_dialog_with_id <span class="s"> + </span>id<span class="s"> + </span><i>"'"</i>);
</code><code id="L613"><a href="#L613" class="ln">613</a>      } <b>else</b> { <span class="c">// <b>if</b> there is a dialog <b>with</b> that id close it</span>
</code><code id="L614"><a href="#L614" class="ln">614</a>        <b>return</b> self.get(id).dialog(<i>'close'</i>); <span class="c">// allow chain returning jQuery obj</span>
</code><code id="L615"><a href="#L615" class="ln">615</a>      }
</code><code id="L616"><a href="#L616" class="ln">616</a>    };
</code><code id="L617"><a href="#L617" class="ln">617</a>
</code><code id="L618"><a href="#L618" class="ln">618</a>    self.closeActive<span class="s"> = </span><b>function</b> () {
</code><code id="L619"><a href="#L619" class="ln">619</a>      <b>var</b> id;
</code><code id="L620"><a href="#L620" class="ln">620</a>      <span class="c">// <b>return</b> <b>if</b> there are no dialogs</span>
</code><code id="L621"><a href="#L621" class="ln">621</a>      <b>if</b> ($.isEmptyObject(dialogs)) {
</code><code id="L622"><a href="#L622" class="ln">622</a>        <b>return</b> <b>false</b>;
</code><code id="L623"><a href="#L623" class="ln">623</a>      }
</code><code id="L624"><a href="#L624" class="ln">624</a>
</code><code id="L625"><a href="#L625" class="ln">625</a>      <span class="c">// <b>delete</b> all dialogs from stack</span>
</code><code id="L626"><a href="#L626" class="ln">626</a>      <b>for</b> (id <b>in</b> dialogs) {
</code><code id="L627"><a href="#L627" class="ln">627</a>        <b>if</b> (dialogs.hasOwnProperty(id)) {
</code><code id="L628"><a href="#L628" class="ln">628</a>          <b>if</b> (self.isOpen(id)) {
</code><code id="L629"><a href="#L629" class="ln">629</a>            self.close(id);
</code><code id="L630"><a href="#L630" class="ln">630</a>          }
</code><code id="L631"><a href="#L631" class="ln">631</a>        }
</code><code id="L632"><a href="#L632" class="ln">632</a>      }
</code><code id="L633"><a href="#L633" class="ln">633</a>      <b>return</b> <b>true</b>;
</code><code id="L634"><a href="#L634" class="ln">634</a>    };
</code><code id="L635"><a href="#L635" class="ln">635</a>
</code><code id="L636"><a href="#L636" class="ln">636</a>    self.showLoading<span class="s"> = </span><b>function</b> ($dialog, autofit) {
</code><code id="L637"><a href="#L637" class="ln">637</a>      <span class="c">// show loading <b>for</b> closing</span>
</code><code id="L638"><a href="#L638" class="ln">638</a>      <b>var</b> text<span class="s"> = </span>$dialog.find(<i>'.contenidoModal'</i>).attr(<i>'data-loading-text'</i>),
</code><code id="L639"><a href="#L639" class="ln">639</a>        modalAutoFit<span class="s"> = </span>(autofit<span class="s"> === </span><b>true</b>) ? <b>true</b> : <b>false</b>,
</code><code id="L640"><a href="#L640" class="ln">640</a>        closingMsg<span class="s"> = </span>_.c_v06_mensajes_cargando({ text: text<span class="s"> || </span>$B.app.literals.cargando }),
</code><code id="L641"><a href="#L641" class="ln">641</a>        $closeButton<span class="s"> = </span>$dialog.find(<i>'.cerrarModal'</i>).hide(),
</code><code id="L642"><a href="#L642" class="ln">642</a>        $cuerpoModal<span class="s"> = </span>$dialog.find(<i>'.contenedorPaso'</i>)[<span class="d">0</span>] ? $dialog.find(<i>'.contenedorPaso'</i>) : $dialog.find(<i>'.contenidoModal'</i>),
</code><code id="L643"><a href="#L643" class="ln">643</a>        cuerpoModalHeight<span class="s"> = </span>$cuerpoModal.outerHeight()<span class="s"> - </span><span class="d">3</span>,
</code><code id="L644"><a href="#L644" class="ln">644</a>        cuerpoModalWidth<span class="s"> = </span>$cuerpoModal.outerWidth()<span class="s"> - </span><span class="d">3</span>,
</code><code id="L645"><a href="#L645" class="ln">645</a>        $closingMsg,
</code><code id="L646"><a href="#L646" class="ln">646</a>        idLoading;
</code><code id="L647"><a href="#L647" class="ln">647</a><span class="c">     <span class="c">/* <b>if</b> ($dialog.hasClass(<i>'c-contenedores-modalDetalle'</i>)) {</span>
</span></code><code id="L648"><a href="#L648" class="ln">648</a><span class="c">        modalAutoFit<span class="s"> = </span><b>true</b>;
</span></code><code id="L649"><a href="#L649" class="ln">649</a><span class="c">      }*/</span>
</code><code id="L650"><a href="#L650" class="ln">650</a>      modalAutoFit<span class="s"> = </span><b>true</b>;
</code><code id="L651"><a href="#L651" class="ln">651</a>      $dialog.find(<i>'.scrollbarModal'</i>).hide();
</code><code id="L652"><a href="#L652" class="ln">652</a>
</code><code id="L653"><a href="#L653" class="ln">653</a>      $cuerpoModal.css({
</code><code id="L654"><a href="#L654" class="ln">654</a>        position: <i>'relative'</i>
</code><code id="L655"><a href="#L655" class="ln">655</a>      });
</code><code id="L656"><a href="#L656" class="ln">656</a>
</code><code id="L657"><a href="#L657" class="ln">657</a>      $cuerpoModal.append(closingMsg).css({position: <i>'relative'</i>});
</code><code id="L658"><a href="#L658" class="ln">658</a>      $closingMsg<span class="s"> = </span>$dialog.find(<i>'.c-mensajes-cargando'</i>).wrap(<i>'&lt;div <b>class</b>="jsLoadingDiv">'</i>).parent().css({
</code><code id="L659"><a href="#L659" class="ln">659</a>        position: <i>'absolute'</i>,
</code><code id="L660"><a href="#L660" class="ln">660</a>        <span class="c">//width: $dialog.width()<span class="s"> - </span><span class="d">2</span>,</span>
</code><code id="L661"><a href="#L661" class="ln">661</a>        width: cuerpoModalWidth,
</code><code id="L662"><a href="#L662" class="ln">662</a>        <span class="c">//height: cuerpoModalHeight,</span>
</code><code id="L663"><a href="#L663" class="ln">663</a>        height: modalAutoFit ? cuerpoModalHeight : <i>'auto'</i>,
</code><code id="L664"><a href="#L664" class="ln">664</a>        backgroundColor: <i>'#fff'</i>,
</code><code id="L665"><a href="#L665" class="ln">665</a>        <span class="c">//left: -<span class="d">9</span>,</span>
</code><code id="L666"><a href="#L666" class="ln">666</a>        left: <span class="d">1</span>,
</code><code id="L667"><a href="#L667" class="ln">667</a><span class="c">        <span class="c">/*top: (<b>function</b> () {</span>
</span></code><code id="L668"><a href="#L668" class="ln">668</a><span class="c">          <b>if</b> (modalAutoFit) {
</span></code><code id="L669"><a href="#L669" class="ln">669</a><span class="c">            <b>return</b> <span class="d">1</span>;
</span></code><code id="L670"><a href="#L670" class="ln">670</a><span class="c">          } <b>else</b> {
</span></code><code id="L671"><a href="#L671" class="ln">671</a><span class="c">            <b>return</b> Math.floor((cuerpoModalHeight<span class="s"> - </span>$dialog.find(<i>'.c-mensajes-cargando'</i>).parent().height())<span class="s"> / </span><span class="d">2</span>);
</span></code><code id="L672"><a href="#L672" class="ln">672</a><span class="c">          }
</span></code><code id="L673"><a href="#L673" class="ln">673</a><span class="c">        }())*/</span>
</code><code id="L674"><a href="#L674" class="ln">674</a>        top: <span class="d">1</span>
</code><code id="L675"><a href="#L675" class="ln">675</a>      })
</code><code id="L676"><a href="#L676" class="ln">676</a>        .end()
</code><code id="L677"><a href="#L677" class="ln">677</a>        .css({
</code><code id="L678"><a href="#L678" class="ln">678</a><span class="c">          <span class="c">/*position: <i>'relative'</i>,</span>
</span></code><code id="L679"><a href="#L679" class="ln">679</a><span class="c">          top: <i>'<span class="d">50</span>%'</i>*/</span>
</code><code id="L680"><a href="#L680" class="ln">680</a>          paddingTop: Math.floor(($dialog.find(<i>'.jsLoadingDiv'</i>).height()<span class="s"> - </span>$dialog.find(<i>'.c-mensajes-cargando'</i>).height())<span class="s"> / </span><span class="d">2</span>)
</code><code id="L681"><a href="#L681" class="ln">681</a>        });
</code><code id="L682"><a href="#L682" class="ln">682</a>
</code><code id="L683"><a href="#L683" class="ln">683</a>      idLoading<span class="s"> = </span>$B.utils.aria.loading($cuerpoModal, <i>'active'</i>);
</code><code id="L684"><a href="#L684" class="ln">684</a>      $cuerpoModal.find(<i>'.c-mensajes-cargando'</i>).first().attr(<i>'id'</i>, idLoading);
</code><code id="L685"><a href="#L685" class="ln">685</a>
</code><code id="L686"><a href="#L686" class="ln">686</a>      <span class="c">// separate so we can get its actual height</span>
</code><code id="L687"><a href="#L687" class="ln">687</a>      $closingMsg.css({
</code><code id="L688"><a href="#L688" class="ln">688</a>        <span class="c">//marginTop: -$closingMsg.height()</span>
</code><code id="L689"><a href="#L689" class="ln">689</a>      });
</code><code id="L690"><a href="#L690" class="ln">690</a>    };
</code><code id="L691"><a href="#L691" class="ln">691</a>
</code><code id="L692"><a href="#L692" class="ln">692</a>    self.removeLoading<span class="s"> = </span><b>function</b> ($dialog) {
</code><code id="L693"><a href="#L693" class="ln">693</a>      <b>var</b> $cuerpoModal<span class="s"> = </span>$dialog.find(<i>'.contenedorPaso'</i>)[<span class="d">0</span>] ? $dialog.find(<i>'.contenedorPaso'</i>) : $dialog.find(<i>'.cuerpoModal'</i>);
</code><code id="L694"><a href="#L694" class="ln">694</a>      $cuerpoModal.css({
</code><code id="L695"><a href="#L695" class="ln">695</a>        position: <i>''</i>
</code><code id="L696"><a href="#L696" class="ln">696</a>      });
</code><code id="L697"><a href="#L697" class="ln">697</a>      $dialog.find(<i>'.c-mensajes-cargando'</i>).parent().remove();
</code><code id="L698"><a href="#L698" class="ln">698</a>      $dialog.find(<i>'.jsLoadingDiv'</i>).remove();
</code><code id="L699"><a href="#L699" class="ln">699</a>      $dialog.find(<i>'.cerrarModal'</i>).show();
</code><code id="L700"><a href="#L700" class="ln">700</a>      $B.utils.aria.loading($cuerpoModal, <i>'inactive'</i>);
</code><code id="L701"><a href="#L701" class="ln">701</a>    };
</code><code id="L702"><a href="#L702" class="ln">702</a>
</code><code id="L703"><a href="#L703" class="ln">703</a>    self.disableBodyScroll<span class="s"> = </span><b>function</b> (disable) {
</code><code id="L704"><a href="#L704" class="ln">704</a>      $(<i>'html'</i>).css(<i>'overflow'</i>, disable ? <i>'hidden'</i> : <i>'visible'</i>);
</code><code id="L705"><a href="#L705" class="ln">705</a>      $(<i>'body'</i>).css(<i>'overflow'</i>, disable ? <i>'scroll'</i> : <i>'auto'</i>);
</code><code id="L706"><a href="#L706" class="ln">706</a>    };
</code><code id="L707"><a href="#L707" class="ln">707</a>
</code><code id="L708"><a href="#L708" class="ln">708</a>    self.focusOutsideDialog<span class="s"> = </span><b>function</b> (link) {
</code><code id="L709"><a href="#L709" class="ln">709</a>      <b>if</b> (link) {
</code><code id="L710"><a href="#L710" class="ln">710</a>        <b>if</b> (link.is(<i>'[tabindex]'</i>)) {
</code><code id="L711"><a href="#L711" class="ln">711</a>          link.focus();
</code><code id="L712"><a href="#L712" class="ln">712</a>        } <b>else</b> {
</code><code id="L713"><a href="#L713" class="ln">713</a>          link.closest(<i>'[tabindex]'</i>).focus();
</code><code id="L714"><a href="#L714" class="ln">714</a>        }
</code><code id="L715"><a href="#L715" class="ln">715</a>      }
</code><code id="L716"><a href="#L716" class="ln">716</a>    };
</code><code id="L717"><a href="#L717" class="ln">717</a>
</code><code id="L718"><a href="#L718" class="ln">718</a>
</code><code id="L719"><a href="#L719" class="ln">719</a><span class="c">    <span class="c">/*\</span>
</span></code><code id="L720"><a href="#L720" class="ln">720</a><span class="c">    <span class="s"> * </span>$B.ui.dialog.create
</span></code><code id="L721"><a href="#L721" class="ln">721</a><span class="c">     [ method ]
</span></code><code id="L722"><a href="#L722" class="ln">722</a><span class="c">    <span class="s"> * </span>Creates a ui dialog <b>with</b> given options
</span></code><code id="L723"><a href="#L723" class="ln">723</a><span class="c">     > Arguments
</span></code><code id="L724"><a href="#L724" class="ln">724</a><span class="c">    <span class="s"> - </span>options (object) object of name/value pairs
</span></code><code id="L725"><a href="#L725" class="ln">725</a><span class="c">     o {
</span></code><code id="L726"><a href="#L726" class="ln">726</a><span class="c">     o    el (string) #optional selector <b>for</b> the element to act as a dialog
</span></code><code id="L727"><a href="#L727" class="ln">727</a><span class="c">     o    id (string) unique id <b>for</b> the dialog
</span></code><code id="L728"><a href="#L728" class="ln">728</a><span class="c">     o    content (string) string content <b>for</b> de dialog (could be the inner html of a div `$(<i>'#myDiv'</i>).html())`
</span></code><code id="L729"><a href="#L729" class="ln">729</a><span class="c">     o    afterLoad (callback) callback <b>function</b> to execute after loading dialog content via ajax
</span></code><code id="L730"><a href="#L730" class="ln">730</a><span class="c">     o    button (object|string) jQuery object or selector <b>for</b> the button that triggers the dialog
</span></code><code id="L731"><a href="#L731" class="ln">731</a><span class="c">     o    url (string, <b>function</b>) url string or <b>function</b> that returns a url string
</span></code><code id="L732"><a href="#L732" class="ln">732</a><span class="c">     o    urlParams (object, <b>function</b>) object or <b>function</b> that returns an object <b>with</b> params <b>for</b> the url
</span></code><code id="L733"><a href="#L733" class="ln">733</a><span class="c">     o    tagName (string) the tagName <b>for</b> creating the dialog <b>if</b> no element was provided (div by <b>default</b>)
</span></code><code id="L734"><a href="#L734" class="ln">734</a><span class="c">     o    dialogOptions (object) Any jQuery ui option (see jquery ui documentation)
</span></code><code id="L735"><a href="#L735" class="ln">735</a><span class="c">     o    onCreate (<b>function</b>) callback that fires only once when the dialog is created
</span></code><code id="L736"><a href="#L736" class="ln">736</a><span class="c">     o }
</span></code><code id="L737"><a href="#L737" class="ln">737</a><span class="c">    <span class="s"> = </span>(object) jQuery object of the dialog content
</span></code><code id="L738"><a href="#L738" class="ln">738</a><span class="c">     > Usage
</span></code><code id="L739"><a href="#L739" class="ln">739</a><span class="c">    <span class="s"> | </span>$B.ui.dialog.create({
</span></code><code id="L740"><a href="#L740" class="ln">740</a><span class="c">    <span class="s"> | </span>  id: <i>'MyDialog'</i>,
</span></code><code id="L741"><a href="#L741" class="ln">741</a><span class="c">    <span class="s"> | </span>  el: <i>'#DialogElement'</i>,
</span></code><code id="L742"><a href="#L742" class="ln">742</a><span class="c">    <span class="s"> | </span>  button: <i>'#button'</i>,
</span></code><code id="L743"><a href="#L743" class="ln">743</a><span class="c">    <span class="s"> | </span>  dialogOptions: {
</span></code><code id="L744"><a href="#L744" class="ln">744</a><span class="c">    <span class="s"> | </span>    draggable: <b>true</b>,
</span></code><code id="L745"><a href="#L745" class="ln">745</a><span class="c">    <span class="s"> | </span>    width: <span class="d">640</span>
</span></code><code id="L746"><a href="#L746" class="ln">746</a><span class="c">    <span class="s"> | </span>  }
</span></code><code id="L747"><a href="#L747" class="ln">747</a><span class="c">    <span class="s"> | </span> });
</span></code><code id="L748"><a href="#L748" class="ln">748</a><span class="c">    \*/</span>
</code><code id="L749"><a href="#L749" class="ln">749</a>    self.create<span class="s"> = </span><b>function</b> (options) {
</code><code id="L750"><a href="#L750" class="ln">750</a>          <span class="c">// <b>default</b> dialog <b>class</b></span>
</code><code id="L751"><a href="#L751" class="ln">751</a>      <b>var</b> settings,
</code><code id="L752"><a href="#L752" class="ln">752</a>        $dialog, <span class="c">// jQuery dialog content obj</span>
</code><code id="L753"><a href="#L753" class="ln">753</a>        $uiDialog, <span class="c">// placeholder <b>for</b> ui dialog element</span>
</code><code id="L754"><a href="#L754" class="ln">754</a>        LOADING_IMG,
</code><code id="L755"><a href="#L755" class="ln">755</a>        onClick,
</code><code id="L756"><a href="#L756" class="ln">756</a>
</code><code id="L757"><a href="#L757" class="ln">757</a>        <span class="c">// <b>default</b> $B.ui.dialog options</span>
</code><code id="L758"><a href="#L758" class="ln">758</a>        defaults<span class="s"> = </span>{
</code><code id="L759"><a href="#L759" class="ln">759</a>          el: <b>null</b>,
</code><code id="L760"><a href="#L760" class="ln">760</a>          id: <i>""</i>,
</code><code id="L761"><a href="#L761" class="ln">761</a>          content: <i>""</i>,
</code><code id="L762"><a href="#L762" class="ln">762</a>          afterLoad: <b>null</b>,
</code><code id="L763"><a href="#L763" class="ln">763</a>          button: <b>null</b>,
</code><code id="L764"><a href="#L764" class="ln">764</a>          url: <b>null</b>,
</code><code id="L765"><a href="#L765" class="ln">765</a>          urlParams: <b>null</b>, <span class="c">// must <b>return</b> an object</span>
</code><code id="L766"><a href="#L766" class="ln">766</a>          tagName: <i>'div'</i>,
</code><code id="L767"><a href="#L767" class="ln">767</a>          resetOnClose: <b>true</b>,
</code><code id="L768"><a href="#L768" class="ln">768</a>          onCreate: <b>null</b>,
</code><code id="L769"><a href="#L769" class="ln">769</a>          dialogClass: <i>'c-contenedores-ventanaModal'</i>,
</code><code id="L770"><a href="#L770" class="ln">770</a>          small: <b>false</b>,
</code><code id="L771"><a href="#L771" class="ln">771</a>          closeOnClick: <b>true</b>,
</code><code id="L772"><a href="#L772" class="ln">772</a>          <span class="c">// defaults <b>for</b> the jQuery UI dialog</span>
</code><code id="L773"><a href="#L773" class="ln">773</a>          dialogOptions: {
</code><code id="L774"><a href="#L774" class="ln">774</a>            zIndex: <span class="d">99999</span>,
</code><code id="L775"><a href="#L775" class="ln">775</a>            autoOpen: <b>false</b>,
</code><code id="L776"><a href="#L776" class="ln">776</a>            modal: <b>true</b>,
</code><code id="L777"><a href="#L777" class="ln">777</a>            show: <i>'fade'</i>,
</code><code id="L778"><a href="#L778" class="ln">778</a>            resizable: <b>false</b>,
</code><code id="L779"><a href="#L779" class="ln">779</a>            draggable: <b>false</b>,
</code><code id="L780"><a href="#L780" class="ln">780</a>            <span class="c">// custom option, save button (init on <b>false</b>)</span>
</code><code id="L781"><a href="#L781" class="ln">781</a>            trigger: <b>false</b>
</code><code id="L782"><a href="#L782" class="ln">782</a>          },
</code><code id="L783"><a href="#L783" class="ln">783</a>          link: <b>false</b>
</code><code id="L784"><a href="#L784" class="ln">784</a>        },
</code><code id="L785"><a href="#L785" class="ln">785</a>        _open,
</code><code id="L786"><a href="#L786" class="ln">786</a>        _close;
</code><code id="L787"><a href="#L787" class="ln">787</a>
</code><code id="L788"><a href="#L788" class="ln">788</a>      <span class="c">// extend dialogOptions</span>
</code><code id="L789"><a href="#L789" class="ln">789</a>      settings<span class="s"> = </span>$.extend(<b>true</b>, {}, defaults, options);
</code><code id="L790"><a href="#L790" class="ln">790</a>
</code><code id="L791"><a href="#L791" class="ln">791</a>      <span class="c">// not used <b>for</b> now</span>
</code><code id="L792"><a href="#L792" class="ln">792</a>      <b>if</b> (settings.small) {
</code><code id="L793"><a href="#L793" class="ln">793</a>        settings.dialogClass += <i>' w640'</i>;
</code><code id="L794"><a href="#L794" class="ln">794</a>      }
</code><code id="L795"><a href="#L795" class="ln">795</a>
</code><code id="L796"><a href="#L796" class="ln">796</a>      <span class="c">// check mandatory params</span>
</code><code id="L797"><a href="#L797" class="ln">797</a>      <b>if</b> (!settings.id) {
</code><code id="L798"><a href="#L798" class="ln">798</a>        <b>throw</b> <b>new</b> Error($B.app.literals.coreLiterals.provide_an_id);
</code><code id="L799"><a href="#L799" class="ln">799</a>      }
</code><code id="L800"><a href="#L800" class="ln">800</a>      <b>if</b> (dialogs[settings.id]) {
</code><code id="L801"><a href="#L801" class="ln">801</a>        <b>throw</b> <b>new</b> Error($B.app.literals.coreLiterals.create_the_id<span class="s"> + </span>settings.id<span class="s"> + </span><i>' '</i><span class="s"> + </span>$B.app.literals.coreLiterals.exists_choose_another);
</code><code id="L802"><a href="#L802" class="ln">802</a>      }
</code><code id="L803"><a href="#L803" class="ln">803</a>
</code><code id="L804"><a href="#L804" class="ln">804</a>      <span class="c">// dialog element could be a string selector or jQuery object</span>
</code><code id="L805"><a href="#L805" class="ln">805</a>      $dialog<span class="s"> = </span>(settings.el <b>instanceof</b> jQuery) ? settings.el : $(settings.el);
</code><code id="L806"><a href="#L806" class="ln">806</a>
</code><code id="L807"><a href="#L807" class="ln">807</a>      <span class="c">// the dialog is not on the dom and there is content provided, create the element and set its content</span>
</code><code id="L808"><a href="#L808" class="ln">808</a>      <b>if</b> (!$dialog[<span class="d">0</span>]<span class="s"> &amp;&amp; </span>settings.content) {
</code><code id="L809"><a href="#L809" class="ln">809</a>        $dialog<span class="s"> = </span>$(document.createElement(settings.tagName));
</code><code id="L810"><a href="#L810" class="ln">810</a>
</code><code id="L811"><a href="#L811" class="ln">811</a>        <span class="c">// insert provided content to the dialog must be string</span>
</code><code id="L812"><a href="#L812" class="ln">812</a>        <b>if</b> (settings.content<span class="s"> &amp;&amp; </span>helpers.isString(settings.content)) {
</code><code id="L813"><a href="#L813" class="ln">813</a>          $dialog.html(settings.content);
</code><code id="L814"><a href="#L814" class="ln">814</a>        } <b>else</b> {
</code><code id="L815"><a href="#L815" class="ln">815</a>          <b>throw</b> <b>new</b> Error($B.app.literals.coreLiterals.content_must_be_string);
</code><code id="L816"><a href="#L816" class="ln">816</a>        }
</code><code id="L817"><a href="#L817" class="ln">817</a>      } <b>else</b> <b>if</b> (!$dialog[<span class="d">0</span>]<span class="s"> &amp;&amp; </span>!settings.content) {
</code><code id="L818"><a href="#L818" class="ln">818</a>        <b>throw</b> <b>new</b> Error($B.app.literals.coreLiterals.the_element<span class="s"> + </span>settings.el<span class="s"> + </span>$B.app.literals.coreLiterals.not_found_on_dom);
</code><code id="L819"><a href="#L819" class="ln">819</a>      }
</code><code id="L820"><a href="#L820" class="ln">820</a>
</code><code id="L821"><a href="#L821" class="ln">821</a>      _open<span class="s"> = </span>settings.dialogOptions.open;
</code><code id="L822"><a href="#L822" class="ln">822</a>      _close<span class="s"> = </span>settings.dialogOptions.close;
</code><code id="L823"><a href="#L823" class="ln">823</a>
</code><code id="L824"><a href="#L824" class="ln">824</a>      settings.dialogOptions.close<span class="s"> = </span><b>function</b> () {
</code><code id="L825"><a href="#L825" class="ln">825</a>        self.disableBodyScroll(<b>false</b>);
</code><code id="L826"><a href="#L826" class="ln">826</a>        <b>if</b> (helpers.isFunction(_close)) {
</code><code id="L827"><a href="#L827" class="ln">827</a>          _close.apply($dialog[<span class="d">0</span>], arguments);
</code><code id="L828"><a href="#L828" class="ln">828</a>        }
</code><code id="L829"><a href="#L829" class="ln">829</a>        self.focusOutsideDialog(settings.link);
</code><code id="L830"><a href="#L830" class="ln">830</a>      };
</code><code id="L831"><a href="#L831" class="ln">831</a>      settings.dialogOptions.destroy<span class="s"> = </span><b>function</b> () {
</code><code id="L832"><a href="#L832" class="ln">832</a>        self.focusOutsideDialog(settings.link);
</code><code id="L833"><a href="#L833" class="ln">833</a>      };
</code><code id="L834"><a href="#L834" class="ln">834</a>
</code><code id="L835"><a href="#L835" class="ln">835</a>      settings.dialogOptions.open<span class="s"> = </span><b>function</b> () {
</code><code id="L836"><a href="#L836" class="ln">836</a>        self.disableBodyScroll(<b>true</b>);
</code><code id="L837"><a href="#L837" class="ln">837</a>        $B.ui.dialogCenter();
</code><code id="L838"><a href="#L838" class="ln">838</a>        <b>if</b> (helpers.isFunction(_open)) {
</code><code id="L839"><a href="#L839" class="ln">839</a>          _open.apply($dialog[<span class="d">0</span>], arguments);
</code><code id="L840"><a href="#L840" class="ln">840</a>        }
</code><code id="L841"><a href="#L841" class="ln">841</a>      };
</code><code id="L842"><a href="#L842" class="ln">842</a>
</code><code id="L843"><a href="#L843" class="ln">843</a>
</code><code id="L844"><a href="#L844" class="ln">844</a>      <span class="c">// initialize jquery ui dialog <b>with</b> options provided</span>
</code><code id="L845"><a href="#L845" class="ln">845</a>      $dialog
</code><code id="L846"><a href="#L846" class="ln">846</a>        .dialog(settings.dialogOptions)
</code><code id="L847"><a href="#L847" class="ln">847</a>        .on(<i>'click.dialog-accept'</i>, <i>'[data-dialog-accept]'</i>, <b>function</b> (event) {
</code><code id="L848"><a href="#L848" class="ln">848</a>          <b>if</b> ($(event.currentTarget).hasClass(<i>'inactivo'</i>)<span class="s"> || </span>$(event.currentTarget).hasClass(<i>'inactivoValidacion'</i>)) {
</code><code id="L849"><a href="#L849" class="ln">849</a>            <b>return</b> <b>false</b>;
</code><code id="L850"><a href="#L850" class="ln">850</a>          }
</code><code id="L851"><a href="#L851" class="ln">851</a>
</code><code id="L852"><a href="#L852" class="ln">852</a>          $dialog.dialog(<i>'close'</i>);
</code><code id="L853"><a href="#L853" class="ln">853</a>          <span class="c">// <b>if</b> there is an accept <b>function</b> defined on the options, call it</span>
</code><code id="L854"><a href="#L854" class="ln">854</a>          <b>if</b> (settings.accept<span class="s"> &amp;&amp; </span>helpers.isFunction(settings.accept)) {
</code><code id="L855"><a href="#L855" class="ln">855</a>            settings.accept.call($dialog, event);
</code><code id="L856"><a href="#L856" class="ln">856</a>          }
</code><code id="L857"><a href="#L857" class="ln">857</a>        })
</code><code id="L858"><a href="#L858" class="ln">858</a>        .on(<i>'click.dialog-close-error'</i>, <i>'[data-cidview-associated]'</i>, <b>function</b> (event) {
</code><code id="L859"><a href="#L859" class="ln">859</a>          <span class="c">// call the same <b>function</b> of appView that closes error msg</span>
</code><code id="L860"><a href="#L860" class="ln">860</a>          $B.router.appView.reloadView(event);
</code><code id="L861"><a href="#L861" class="ln">861</a>        });
</code><code id="L862"><a href="#L862" class="ln">862</a>
</code><code id="L863"><a href="#L863" class="ln">863</a>      <b>if</b> (settings.closeOnClick) {
</code><code id="L864"><a href="#L864" class="ln">864</a>        $dialog.on(<i>'click.dialog-close'</i>, <i>'[data-dialog-close], [data-dialog-cancel]'</i>, <b>function</b> () {
</code><code id="L865"><a href="#L865" class="ln">865</a>          $dialog.dialog(<i>'close'</i>);
</code><code id="L866"><a href="#L866" class="ln">866</a>        });
</code><code id="L867"><a href="#L867" class="ln">867</a>      }
</code><code id="L868"><a href="#L868" class="ln">868</a>
</code><code id="L869"><a href="#L869" class="ln">869</a>      <span class="c">// External stuff</span>
</code><code id="L870"><a href="#L870" class="ln">870</a>      $B.ui.initFormComponents($dialog);
</code><code id="L871"><a href="#L871" class="ln">871</a>      $B.ui.c_buscadores_predictivoLiquido($dialog.find(<i>'.c-buscadores-predictivo-liquido'</i>));
</code><code id="L872"><a href="#L872" class="ln">872</a>      <span class="c">// end External stuff</span>
</code><code id="L873"><a href="#L873" class="ln">873</a>
</code><code id="L874"><a href="#L874" class="ln">874</a>      <span class="c">// get ui dialog element</span>
</code><code id="L875"><a href="#L875" class="ln">875</a>      $uiDialog<span class="s"> = </span>$($dialog.data(<i>'dialog'</i>).uiDialog).attr(<i>'id'</i>, <i>'ui-dialog-'</i><span class="s"> + </span>settings.id).addClass(settings.dialogClass);
</code><code id="L876"><a href="#L876" class="ln">876</a>
</code><code id="L877"><a href="#L877" class="ln">877</a>      <b>if</b> (settings.dialogOptions.height<span class="s"> &amp;&amp; </span>_.isNumber(settings.dialogOptions.height)) {
</code><code id="L878"><a href="#L878" class="ln">878</a>        $uiDialog.attr(<i>'data-fixed-height'</i>, settings.dialogOptions.height);
</code><code id="L879"><a href="#L879" class="ln">879</a>      }
</code><code id="L880"><a href="#L880" class="ln">880</a>
</code><code id="L881"><a href="#L881" class="ln">881</a>      <b>if</b> (settings.dialogClass !== <i>'c-contenedores-modalDetalle'</i>) {
</code><code id="L882"><a href="#L882" class="ln">882</a>        <b>if</b> (settings.dialogOptions.width &lt; <span class="d">700</span>) {
</code><code id="L883"><a href="#L883" class="ln">883</a>          <span class="c">// pequenyo</span>
</code><code id="L884"><a href="#L884" class="ln">884</a>          $uiDialog.addClass(<i>'w640'</i>);
</code><code id="L885"><a href="#L885" class="ln">885</a>          $dialog.find(<i>'.cuerpoModal'</i>).addClass(<i>'container_8'</i>);
</code><code id="L886"><a href="#L886" class="ln">886</a>        } <b>else</b> {
</code><code id="L887"><a href="#L887" class="ln">887</a>          <span class="c">// grande</span>
</code><code id="L888"><a href="#L888" class="ln">888</a>          $dialog.find(<i>'.cuerpoModal'</i>).addClass(<i>'container_12'</i>);
</code><code id="L889"><a href="#L889" class="ln">889</a>        }
</code><code id="L890"><a href="#L890" class="ln">890</a>      }
</code><code id="L891"><a href="#L891" class="ln">891</a>
</code><code id="L892"><a href="#L892" class="ln">892</a>      <span class="c">// set dialog width from its data-dialog-width attribute</span>
</code><code id="L893"><a href="#L893" class="ln">893</a>      <span class="c">// must be a <b>class</b> e.i. data-dialog-width=<i>"w640"</i></span>
</code><code id="L894"><a href="#L894" class="ln">894</a>      privates.setWidth($dialog, $uiDialog);
</code><code id="L895"><a href="#L895" class="ln">895</a>
</code><code id="L896"><a href="#L896" class="ln">896</a>      <span class="c">// attach event handler to fix tab to the dialog when opened</span>
</code><code id="L897"><a href="#L897" class="ln">897</a>      privates.fixDialogTabbing($dialog, $uiDialog);
</code><code id="L898"><a href="#L898" class="ln">898</a>
</code><code id="L899"><a href="#L899" class="ln">899</a>      <span class="c">// add to dialogs stack</span>
</code><code id="L900"><a href="#L900" class="ln">900</a>      privates.add(settings.id, $dialog, settings.isCore);
</code><code id="L901"><a href="#L901" class="ln">901</a>
</code><code id="L902"><a href="#L902" class="ln">902</a>      <span class="c">// <b>if</b> resetOnClose is <b>true</b> (by <b>default</b> it is), resets the form inside the dialog</span>
</code><code id="L903"><a href="#L903" class="ln">903</a>      <b>if</b> (settings.resetOnClose) {
</code><code id="L904"><a href="#L904" class="ln">904</a>        privates.reset($dialog);
</code><code id="L905"><a href="#L905" class="ln">905</a>      }
</code><code id="L906"><a href="#L906" class="ln">906</a>
</code><code id="L907"><a href="#L907" class="ln">907</a>      <span class="c">// call onCreate callback (run once when modal is created)</span>
</code><code id="L908"><a href="#L908" class="ln">908</a>      <b>if</b> (settings.onCreate<span class="s"> &amp;&amp; </span>helpers.isFunction(settings.onCreate)) {
</code><code id="L909"><a href="#L909" class="ln">909</a>        settings.onCreate.call($dialog);
</code><code id="L910"><a href="#L910" class="ln">910</a>      }
</code><code id="L911"><a href="#L911" class="ln">911</a>
</code><code id="L912"><a href="#L912" class="ln">912</a>      <span class="c">// TODO:</span>
</code><code id="L913"><a href="#L913" class="ln">913</a>      <span class="c">// loading image/element</span>
</code><code id="L914"><a href="#L914" class="ln">914</a>      LOADING_IMG<span class="s"> = </span><i>''</i>;<span class="c">// $(<i>'&lt;div <b>class</b>="ui-helper-hidden">Cargando...&lt;/div>'</i>).insertBefore($dialog);</span>
</code><code id="L915"><a href="#L915" class="ln">915</a>
</code><code id="L916"><a href="#L916" class="ln">916</a>      <span class="c">// <b>if</b> there is an element defined to open the dialog, attach click event</span>
</code><code id="L917"><a href="#L917" class="ln">917</a>      <b>if</b> (settings.button) {
</code><code id="L918"><a href="#L918" class="ln">918</a>        <span class="c">// <b>if</b> is not a jQuery obj but a string selector wrap it <b>with</b> jQuery</span>
</code><code id="L919"><a href="#L919" class="ln">919</a>
</code><code id="L920"><a href="#L920" class="ln">920</a>        <b>if</b> (!helpers.isString(settings.button)) {
</code><code id="L921"><a href="#L921" class="ln">921</a>          <b>throw</b> <b>new</b> Error($B.app.literals.coreLiterals.button_must_be_string);
</code><code id="L922"><a href="#L922" class="ln">922</a>        }
</code><code id="L923"><a href="#L923" class="ln">923</a>
</code><code id="L924"><a href="#L924" class="ln">924</a>        <span class="c">// <b>default</b> click <b>function</b> <b>for</b> opening the dialog</span>
</code><code id="L925"><a href="#L925" class="ln">925</a>        onClick<span class="s"> = </span><b>function</b> (ev) {
</code><code id="L926"><a href="#L926" class="ln">926</a>          ev.preventDefault();
</code><code id="L927"><a href="#L927" class="ln">927</a>
</code><code id="L928"><a href="#L928" class="ln">928</a>          <b>var</b> $trigger<span class="s"> = </span>$(<b>this</b>);
</code><code id="L929"><a href="#L929" class="ln">929</a>
</code><code id="L930"><a href="#L930" class="ln">930</a>          <span class="c">// open the dialog</span>
</code><code id="L931"><a href="#L931" class="ln">931</a>          <span class="c">// save a referece of the element that triggered <b>this</b> dialog</span>
</code><code id="L932"><a href="#L932" class="ln">932</a>          $dialog
</code><code id="L933"><a href="#L933" class="ln">933</a>            .dialog({trigger: { btn: $trigger, selector: settings.button }})
</code><code id="L934"><a href="#L934" class="ln">934</a>            .dialog(<i>'open'</i>);
</code><code id="L935"><a href="#L935" class="ln">935</a>
</code><code id="L936"><a href="#L936" class="ln">936</a>          <span class="c">// <b>if</b> there is a url provided load the dialog content from there</span>
</code><code id="L937"><a href="#L937" class="ln">937</a>          <b>if</b> (settings.url) {
</code><code id="L938"><a href="#L938" class="ln">938</a>            <span class="c">// allow the url be a <b>function</b></span>
</code><code id="L939"><a href="#L939" class="ln">939</a>            <b>if</b> (helpers.isFunction(settings.url)) {
</code><code id="L940"><a href="#L940" class="ln">940</a>              settings.url<span class="s"> = </span>settings.url.call(<b>this</b>);
</code><code id="L941"><a href="#L941" class="ln">941</a>              <b>if</b> (!helpers.isString(settings.url)) {
</code><code id="L942"><a href="#L942" class="ln">942</a>                <b>throw</b> <b>new</b> Error($B.app.literals.coreLiterals.url_must_be_string);
</code><code id="L943"><a href="#L943" class="ln">943</a>              }
</code><code id="L944"><a href="#L944" class="ln">944</a>            }
</code><code id="L945"><a href="#L945" class="ln">945</a>            self.load.call($dialog, settings);
</code><code id="L946"><a href="#L946" class="ln">946</a>          } <b>else</b> <b>if</b> (settings.ajax) { <span class="c">// <b>if</b> ajax is <b>true</b> get the url from the href attribute or from data-dialog-url</span>
</code><code id="L947"><a href="#L947" class="ln">947</a>            settings.url<span class="s"> = </span>$trigger.attr(<i>"href"</i>)<span class="s"> || </span>$trigger.data(<i>"dialog-url"</i>);
</code><code id="L948"><a href="#L948" class="ln">948</a>            <span class="c">// <b>if</b> we couldn't get the url from href</span>
</code><code id="L949"><a href="#L949" class="ln">949</a>            <b>if</b> (!settings.url) {
</code><code id="L950"><a href="#L950" class="ln">950</a>              <b>throw</b> <b>new</b> Error($B.app.literals.coreLiterals.specify_a_url);
</code><code id="L951"><a href="#L951" class="ln">951</a>            }
</code><code id="L952"><a href="#L952" class="ln">952</a>            self.load.call($dialog, settings);
</code><code id="L953"><a href="#L953" class="ln">953</a>          }
</code><code id="L954"><a href="#L954" class="ln">954</a>        };
</code><code id="L955"><a href="#L955" class="ln">955</a>
</code><code id="L956"><a href="#L956" class="ln">956</a>        <span class="c">// save a referece of the element that triggered <b>this</b> dialog (as a string <b>if</b> not opened yet)</span>
</code><code id="L957"><a href="#L957" class="ln">957</a>        $dialog.dialog({trigger: { btn: $(settings.button), selector: settings.button }});
</code><code id="L958"><a href="#L958" class="ln">958</a>
</code><code id="L959"><a href="#L959" class="ln">959</a>        <span class="c">// delegate click event from document</span>
</code><code id="L960"><a href="#L960" class="ln">960</a>        $(document).on(<i>'click.b-dialog-open'</i>, settings.button, onClick);
</code><code id="L961"><a href="#L961" class="ln">961</a>
</code><code id="L962"><a href="#L962" class="ln">962</a>      <span class="c">// no button provided</span>
</code><code id="L963"><a href="#L963" class="ln">963</a>      } <b>else</b> <b>if</b> (settings.ajax<span class="s"> || </span>settings.url) {
</code><code id="L964"><a href="#L964" class="ln">964</a>        <span class="c">// load content on open</span>
</code><code id="L965"><a href="#L965" class="ln">965</a>        $dialog.dialog({
</code><code id="L966"><a href="#L966" class="ln">966</a>          open: <b>function</b> (ev, ui) {
</code><code id="L967"><a href="#L967" class="ln">967</a>            self.load.call($dialog, settings);
</code><code id="L968"><a href="#L968" class="ln">968</a>          }
</code><code id="L969"><a href="#L969" class="ln">969</a>        });
</code><code id="L970"><a href="#L970" class="ln">970</a>
</code><code id="L971"><a href="#L971" class="ln">971</a>      <span class="c">// no ajax or url</span>
</code><code id="L972"><a href="#L972" class="ln">972</a>      } <b>else</b> {
</code><code id="L973"><a href="#L973" class="ln">973</a>        $dialog.dialog();
</code><code id="L974"><a href="#L974" class="ln">974</a>      }
</code><code id="L975"><a href="#L975" class="ln">975</a>
</code><code id="L976"><a href="#L976" class="ln">976</a>      $B.ui.dialogCenter();
</code><code id="L977"><a href="#L977" class="ln">977</a>
</code><code id="L978"><a href="#L978" class="ln">978</a>      <b>return</b> $dialog;
</code><code id="L979"><a href="#L979" class="ln">979</a>    };
</code><code id="L980"><a href="#L980" class="ln">980</a>
</code><code id="L981"><a href="#L981" class="ln">981</a>
</code><code id="L982"><a href="#L982" class="ln">982</a>    self.load<span class="s"> = </span><b>function</b> (settings) {
</code><code id="L983"><a href="#L983" class="ln">983</a>      <b>var</b> $dialog<span class="s"> = </span><b>this</b>,
</code><code id="L984"><a href="#L984" class="ln">984</a>        loadingImg<span class="s"> = </span>$dialog.prev().show(), <span class="c">// show loading img</span>
</code><code id="L985"><a href="#L985" class="ln">985</a>        <span class="c">// allow params to be a <b>function</b></span>
</code><code id="L986"><a href="#L986" class="ln">986</a>        _dataToSend<span class="s"> = </span>(settings.urlParams) ? helpers.isFunction(settings.urlParams) ? settings.urlParams() : settings.urlParams : {};
</code><code id="L987"><a href="#L987" class="ln">987</a>
</code><code id="L988"><a href="#L988" class="ln">988</a>      <b>if</b> (_dataToSend<span class="s"> &amp;&amp; </span>!helpers.isObject(_dataToSend)) {
</code><code id="L989"><a href="#L989" class="ln">989</a>        <b>throw</b> <b>new</b> Error($B.app.literals.coreLiterals.urlParams_must_be_object);
</code><code id="L990"><a href="#L990" class="ln">990</a>      }
</code><code id="L991"><a href="#L991" class="ln">991</a>
</code><code id="L992"><a href="#L992" class="ln">992</a>      <span class="c">// prevent url caching adding a timestamp</span>
</code><code id="L993"><a href="#L993" class="ln">993</a>      <b>if</b> (!settings.cache) {
</code><code id="L994"><a href="#L994" class="ln">994</a>        _dataToSend.t<span class="s"> = </span><b>new</b> Date().getTime();
</code><code id="L995"><a href="#L995" class="ln">995</a>      }
</code><code id="L996"><a href="#L996" class="ln">996</a>
</code><code id="L997"><a href="#L997" class="ln">997</a>      <span class="c">// empty any dialog content and load the <b>new</b> one</span>
</code><code id="L998"><a href="#L998" class="ln">998</a>      $dialog.empty().load(settings.url, _dataToSend, <b>function</b> (response, status, xhr) {
</code><code id="L999"><a href="#L999" class="ln">999</a>        <span class="c">// hide loading img</span>
</code><code id="L1000"><a href="#L1000" class="ln">1000</a>        loadingImg.hide();
</code><code id="L1001"><a href="#L1001" class="ln">1001</a>
</code><code id="L1002"><a href="#L1002" class="ln">1002</a>        <span class="c">// <b>if</b> status <span class="d">401</span> redirect to login</span>
</code><code id="L1003"><a href="#L1003" class="ln">1003</a>        <b>if</b> (xhr.status<span class="s"> === </span><span class="d">401</span>) {
</code><code id="L1004"><a href="#L1004" class="ln">1004</a>          location.reload();
</code><code id="L1005"><a href="#L1005" class="ln">1005</a>          <b>return</b> <b>false</b>;
</code><code id="L1006"><a href="#L1006" class="ln">1006</a>        } <b>else</b> <b>if</b> (xhr.status<span class="s"> === </span><span class="d">500</span>) { <span class="c">// show error on <span class="d">500</span></span>
</code><code id="L1007"><a href="#L1007" class="ln">1007</a>          $dialog.html(<i>'&lt;p>'</i><span class="s"> + </span>$B.app.literals.error_msg<span class="s"> + </span><i>'&lt;/p>'</i>);
</code><code id="L1008"><a href="#L1008" class="ln">1008</a>          <b>return</b> <b>false</b>;
</code><code id="L1009"><a href="#L1009" class="ln">1009</a>        } <b>else</b> <b>if</b> (settings.afterLoad<span class="s"> &amp;&amp; </span>helpers.isFunction(settings.afterLoad)) { <span class="c">// all ok call afterLoad fn <b>if</b> defined</span>
</code><code id="L1010"><a href="#L1010" class="ln">1010</a>          <span class="c">// pass the dialog elem as context</span>
</code><code id="L1011"><a href="#L1011" class="ln">1011</a>          settings.afterLoad.apply($dialog, arguments);
</code><code id="L1012"><a href="#L1012" class="ln">1012</a>        }
</code><code id="L1013"><a href="#L1013" class="ln">1013</a>      });
</code><code id="L1014"><a href="#L1014" class="ln">1014</a>    };
</code><code id="L1015"><a href="#L1015" class="ln">1015</a>
</code><code id="L1016"><a href="#L1016" class="ln">1016</a>    <b>return</b> self;
</code><code id="L1017"><a href="#L1017" class="ln">1017</a>  }());
</code><code id="L1018"><a href="#L1018" class="ln">1018</a>}(jQuery, window));
</code><code id="L1019"><a href="#L1019" class="ln">1019</a>
</code></pre>
</body>
